<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="hpm__mcl__encoder_8c" kind="file" language="C++">
    <compoundname>hpm_mcl_encoder.c</compoundname>
    <includes local="no">math.h</includes>
    <includes refid="hpm__mcl__encoder_8h" local="yes">hpm_mcl_encoder.h</includes>
    <includes refid="hpm__mcl__physical_8h" local="yes">hpm_mcl_physical.h</includes>
    <incdepgraph>
      <node id="5">
        <label>hpm_common.h</label>
        <link refid="hpm__common_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>hpm_mcl_filter.h</label>
        <link refid="hpm__mcl__filter_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c</label>
        <link refid="hpm__mcl__encoder_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>hpm_mcl_encoder.h</label>
        <link refid="hpm__mcl__encoder_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>hpm_mcl_cfg.h</label>
        <link refid="hpm__mcl__cfg_8h"/>
      </node>
      <node id="4">
        <label>hpm_mcl_common.h</label>
        <link refid="hpm__mcl__common_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>hpm_mcl_math.h</label>
        <link refid="hpm__mcl__math_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>hpm_mcl_physical.h</label>
        <link refid="hpm__mcl__physical_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>assert.h</label>
      </node>
      <node id="2">
        <label>math.h</label>
      </node>
      <node id="7">
        <label>stdbool.h</label>
      </node>
      <node id="8">
        <label>stdint.h</label>
      </node>
      <node id="14">
        <label>stdio.h</label>
      </node>
      <node id="10">
        <label>stdlib.h</label>
      </node>
      <node id="9">
        <label>string.h</label>
      </node>
    </incdepgraph>
    <sectiondef kind="func">
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a0c3b77c8d50cba6c95816b8eb555ecea" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref></type>
        <definition>hpm_mcl_stat_t hpm_mcl_encoder_init</definition>
        <argsstring>(mcl_encoder_t *encoder, mcl_cfg_t *mcl_cfg, mcl_encoer_cfg_t *encoder_cfg, mcl_filter_iir_df1_t *iir)</argsstring>
        <name>hpm_mcl_encoder_init</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <param>
          <type><ref refid="structmcl__cfg__t" kindref="compound">mcl_cfg_t</ref> *</type>
          <declname>mcl_cfg</declname>
        </param>
        <param>
          <type><ref refid="structmcl__encoer__cfg__t" kindref="compound">mcl_encoer_cfg_t</ref> *</type>
          <declname>encoder_cfg</declname>
        </param>
        <param>
          <type><ref refid="structmcl__filter__iir__df1__t" kindref="compound">mcl_filter_iir_df1_t</ref> *</type>
          <declname>iir</declname>
        </param>
        <briefdescription>
<para>Initialize encoder data. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>mcl_cfg</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__cfg__t" kindref="compound">mcl_cfg_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>encoder_cfg</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoer__cfg__t" kindref="compound">mcl_encoer_cfg_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>iir</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__filter__iir__df1__t" kindref="compound">mcl_filter_iir_df1_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
<para>parameter check</para>
<para>null function initialisation</para>
<para>parameter initial</para>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="11" column="16" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="11" bodyend="62"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a0c0cb83fb5da4e216567125747517da0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref></type>
        <definition>hpm_mcl_stat_t hpm_mcl_encoder_start_sample</definition>
        <argsstring>(mcl_encoder_t *encoder)</argsstring>
        <name>hpm_mcl_encoder_start_sample</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <briefdescription>
<para>Encoder starts sampling. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="64" column="16" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="64" bodyend="77"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a488c3471f2d49a3565f9eab503472faa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref></type>
        <definition>hpm_mcl_stat_t hpm_mcl_encoder_set_initial_theta</definition>
        <argsstring>(mcl_encoder_t *encoder, float theta)</argsstring>
        <name>hpm_mcl_encoder_set_initial_theta</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <param>
          <type>float</type>
          <declname>theta</declname>
        </param>
        <briefdescription>
<para>Sets the initial value of the angle. Normally, the programme does the initial value setting automatically, but if you are not satisfied with the result, you can set the initial value. The initial value determines the zero point of the electrical angle. This means that the angle read by the sensor is calibrated to zero by the initial value. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>theta</parametername>
</parameternamelist>
<parameterdescription>
<para>Used to calibrate electrical angle to zero </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> <ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="79" column="16" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="79" bodyend="85"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a570404d74284f07ad4f0a671f58c6f6e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref></type>
        <definition>hpm_mcl_stat_t hpm_mcl_encoder_process</definition>
        <argsstring>(mcl_encoder_t *encoder, uint32_t tick_deta)</argsstring>
        <name>hpm_mcl_encoder_process</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>tick_deta</declname>
        </param>
        <briefdescription>
<para>Encoder processing, cycle call. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>tick_deta</parametername>
</parameternamelist>
<parameterdescription>
<para>Difference in the number of cycles between two calls </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
<para>iir filter</para>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="87" column="16" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="87" bodyend="192"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1ae5fb00ae11775e198b3006df7c219504" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref></type>
        <definition>hpm_mcl_stat_t hpm_mcl_encoder_set_status</definition>
        <argsstring>(mcl_encoder_t *encoder, mcl_encoder_status_t status)</argsstring>
        <name>hpm_mcl_encoder_set_status</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <param>
          <type><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7" kindref="member">mcl_encoder_status_t</ref></type>
          <declname>status</declname>
        </param>
        <briefdescription>
<para>Force update of encoder status. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>status</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7" kindref="member">mcl_encoder_status_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="194" column="16" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="194" bodyend="199"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a850d2f8593c93fdd6110defd602459c7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void hpm_mcl_encoder_force_theta</definition>
        <argsstring>(mcl_encoder_t *encoder, float theta, bool enable)</argsstring>
        <name>hpm_mcl_encoder_force_theta</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <param>
          <type>float</type>
          <declname>theta</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>enable</declname>
        </param>
        <briefdescription>
<para>Force setting of the output angle of the encoder function. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>theta</parametername>
</parameternamelist>
<parameterdescription>
<para>rad </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>enable</parametername>
</parameternamelist>
<parameterdescription>
<para>Enable or disable the forced output function </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="201" column="6" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="201" bodyend="205"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1ae52331fddf8b6b71707c5b21c31bad6e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float hpm_mcl_encoder_get_raw_theta</definition>
        <argsstring>(mcl_encoder_t *encoder)</argsstring>
        <name>hpm_mcl_encoder_get_raw_theta</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <briefdescription>
<para>Getting the raw angle data of the encoder. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>theta, rad </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="207" column="7" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="207" bodyend="214"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a2dd59824fc0a0751c697088158e0e5e0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float hpm_mcl_encoder_get_theta</definition>
        <argsstring>(mcl_encoder_t *encoder)</argsstring>
        <name>hpm_mcl_encoder_get_theta</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <briefdescription>
<para>Get the encoder angle value. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>angle value, rad </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="216" column="7" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="216" bodyend="223"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1ae13b8fb0b56887159f269458f0e004be" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float hpm_mcl_encoder_get_sensorless_theta</definition>
        <argsstring>(mcl_encoder_t *encoder)</argsstring>
        <name>hpm_mcl_encoder_get_sensorless_theta</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <briefdescription>
<para>Get sensorless theta. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>theta </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="225" column="7" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="225" bodyend="228"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a7a6b6bc0edcb28692798f6950ef3f223" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float hpm_mcl_encoder_get_speed</definition>
        <argsstring>(mcl_encoder_t *encoder)</argsstring>
        <name>hpm_mcl_encoder_get_speed</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <briefdescription>
<para>Get speed. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>rad/s </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="230" column="7" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="230" bodyend="233"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a4ad192a198270565a6cb71e1fd8d9f67" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float hpm_mcl_encoder_get_forecast_theta</definition>
        <argsstring>(mcl_encoder_t *encoder)</argsstring>
        <name>hpm_mcl_encoder_get_forecast_theta</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <briefdescription>
<para>Get the angle predicted from the speed. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>theta, rad </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="235" column="7" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="235" bodyend="238"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1adc0e5b4f2d1fa7d929c49edbde81db6f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref></type>
        <definition>hpm_mcl_stat_t hpm_mcl_encoder_get_absolute_theta</definition>
        <argsstring>(mcl_encoder_t *encoder, float *theta)</argsstring>
        <name>hpm_mcl_encoder_get_absolute_theta</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>theta</declname>
        </param>
        <briefdescription>
<para>Get the absolute position of the angle. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>theta</parametername>
</parameternamelist>
<parameterdescription>
<para>rad </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="240" column="16" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="240" bodyend="244"/>
      </memberdef>
      <memberdef kind="function" id="hpm__mcl__encoder_8c_1a4b3eb72f466cba80de2d95ef9c798246" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref></type>
        <definition>hpm_mcl_stat_t hpm_mcl_encoder_get_uvw_status</definition>
        <argsstring>(mcl_encoder_t *encoder, mcl_encoder_uvw_level_t *level)</argsstring>
        <name>hpm_mcl_encoder_get_uvw_status</name>
        <param>
          <type><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> *</type>
          <declname>encoder</declname>
        </param>
        <param>
          <type><ref refid="structmcl__encoder__uvw__level__t" kindref="compound">mcl_encoder_uvw_level_t</ref> *</type>
          <declname>level</declname>
        </param>
        <briefdescription>
<para>Get level status of uvw. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>encoder</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>level</parametername>
</parameternamelist>
<parameterdescription>
<para>0: low , 1: high </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref> </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" line="246" column="16" bodyfile="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c" bodystart="246" bodyend="250"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2023<sp/>HPMicro</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>SPDX-License-Identifier:<sp/>BSD-3-Clause</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="hpm__mcl__encoder_8h" kindref="compound">hpm_mcl_encoder.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="hpm__mcl__physical_8h" kindref="compound">hpm_mcl_physical.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/><ref refid="hpm__mcl__encoder_8c_1a0c3b77c8d50cba6c95816b8eb555ecea" kindref="member">hpm_mcl_encoder_init</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder,<sp/><ref refid="structmcl__cfg__t" kindref="compound">mcl_cfg_t</ref><sp/>*mcl_cfg,<sp/><ref refid="structmcl__encoer__cfg__t" kindref="compound">mcl_encoer_cfg_t</ref><sp/>*encoder_cfg,<sp/><ref refid="structmcl__filter__iir__df1__t" kindref="compound">mcl_filter_iir_df1_t</ref><sp/>*iir)</highlight></codeline>
<codeline lineno="12"><highlight class="normal">{</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder<sp/>!=<sp/>NULL,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7ab6147603912b254d747825d8f68c5508" kindref="member">encoder_status_null</ref>;</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(mcl_cfg<sp/>!=<sp/>NULL,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder_cfg<sp/>!=<sp/>NULL,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(iir<sp/>!=<sp/>NULL,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>((encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a0976346978710ff6fb34a8cd238d0e4d" kindref="member">start_sample</ref><sp/>!=<sp/>NULL),<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(((encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1ac23339131d52010f08757e12b68e3821" kindref="member">disable_start_sample_interrupt</ref><sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>||<sp/>(encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a57259c85020b084de465c7787ec73e25" kindref="member">get_lead_tick</ref><sp/>!=<sp/>NULL)),<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(((encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1ac23339131d52010f08757e12b68e3821" kindref="member">disable_start_sample_interrupt</ref><sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>||<sp/>(encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a334169067bbe880edcc37af7b5024568" kindref="member">update_trig_lead_tick</ref><sp/>!=<sp/>NULL)),<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>((encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a40b1b524ee26367cdc34f82056863e09" kindref="member">get_theta</ref><sp/>!=<sp/>NULL),<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>((encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a78ea4b8313d43543e74c693369cba547" kindref="member">speed_cal_method</ref><sp/>!=<sp/><ref refid="hpm__mcl__encoder_8h_1add0d8d359bdd218ea5cc5e2d3cf8a6b6abb15c589692e87efa72f4f8b97a00730" kindref="member">encoder_method_user</ref>)<sp/>||<sp/>(encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1ade356bcdd6b141f637a0c22095d7582e" kindref="member">process_by_user</ref><sp/>!=<sp/>NULL),<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a5df83cb02f3d9deca64a321eca8158b9" kindref="member">mcl_invalid_argument</ref>);</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a6a21574c119dd3ffd5841a3278dd942e" kindref="member">memory</ref>,<sp/>0,<sp/><ref refid="hpm__mcl__encoder_8h_1ad2a152bb007b7c70eaef461704193a57" kindref="member">MCL_ENCODER_CAL_STRUCT_MAX_MEMMORY</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(uint32_t));</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a9faeb8989d212f9e0ffb05e601824db0" kindref="member">mcu_clock_tick</ref><sp/>=<sp/>&amp;mcl_cfg-&gt;<ref refid="structmcl__cfg__t_1add1b0983240b6f82d3bc5753ac37844b" kindref="member">physical</ref>.<ref refid="structmcl__physical__para__t_1a59c5e3dc084e59a8f55c3d8c562d9242" kindref="member">time</ref>.<ref refid="structphysical__time__t_1ad568c059bddb5acb00c9c9efdd8d3ae4" kindref="member">mcu_clock_tick</ref>;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1a5f15458ac84f45836cc155915ba869e0" kindref="member">cfg</ref><sp/>=<sp/>(<ref refid="structmcl__encoder__cal__speed__pll__cfg__t" kindref="compound">mcl_encoder_cal_speed_pll_cfg_t</ref><sp/>*)&amp;encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a8f31674ad11c34c19e57de7a486fea81" kindref="member">cal_speed_pll_cfg</ref>;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1ad66c660c7f0856cb47e76c1210cf699a" kindref="member">period_call_time_s</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*)&amp;encoder_cfg-&gt;<ref refid="structmcl__encoer__cfg__t_1a0a0b872e4b9711b80d44f0944f937632" kindref="member">period_call_time_s</ref>;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a06e658718f9935ac990b5147a023359d" kindref="member">iirfilter</ref><sp/>=<sp/>iir;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1af9a069250edf1a130b084e51b5ac3036" kindref="member">current_loop_ts</ref><sp/>=<sp/>&amp;mcl_cfg-&gt;<ref refid="structmcl__cfg__t_1add1b0983240b6f82d3bc5753ac37844b" kindref="member">physical</ref>.<ref refid="structmcl__physical__para__t_1a59c5e3dc084e59a8f55c3d8c562d9242" kindref="member">time</ref>.<ref refid="structphysical__time__t_1ab094266269b29f78319d74d3789daca8" kindref="member">current_loop_ts</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1ac1b0cf668ab44768481e6a83f1922914" kindref="member">pole_num</ref><sp/>=<sp/>&amp;mcl_cfg-&gt;<ref refid="structmcl__cfg__t_1add1b0983240b6f82d3bc5753ac37844b" kindref="member">physical</ref>.<ref refid="structmcl__physical__para__t_1aaef826e4f0231d758be293230a12200c" kindref="member">motor</ref>.<ref refid="structphysical__motor__t_1a9ba7c5f0c1097a17433c9c31a6e211f1" kindref="member">pole_num</ref>;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref><sp/>=<sp/>encoder_cfg;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1ab7b2a0e8d33c70a65b932979b7c49cdf" kindref="member">phase</ref><sp/>=<sp/>&amp;mcl_cfg-&gt;<ref refid="structmcl__cfg__t_1add1b0983240b6f82d3bc5753ac37844b" kindref="member">physical</ref>.<ref refid="structmcl__physical__para__t_1aaef826e4f0231d758be293230a12200c" kindref="member">motor</ref>.<ref refid="structphysical__motor__t_1a809011fb88e8200e6e80a2b7fccaf155" kindref="member">hall</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a8513acffbbee1b172a7ab305d0c93bad" kindref="member">speed</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a9c5dc3fd47c7e9020ac36a197d36cf7c" kindref="member">theta</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a0c5a02541b3e214eb74510cf353887bb" kindref="member">theta_forecast</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(iir-&gt;<ref refid="structmcl__filter__iir__df1__t_1a15640933ccf63eabff39e27a376d5af5" kindref="member">mem</ref>,<sp/>0,<sp/>iir-&gt;<ref refid="structmcl__filter__iir__df1__t_1aa505c6ddb00741c4681d12a9abda1b84" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__filter__iir__df1__cfg__t_1ac80ed0899a9ec325c600ec81d422c662" kindref="member">section</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structmcl__filter__iir__df1__memory__t" kindref="compound">mcl_filter_iir_df1_memory_t</ref>));</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a151439c5499b569bcbe92028bec514f7" kindref="member">force_set_theta</ref>.<ref refid="structmcl__user__value__t_1abbb68a18f8ba945c402a8d34792639fc" kindref="member">enable</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a151439c5499b569bcbe92028bec514f7" kindref="member">force_set_theta</ref>.<ref refid="structmcl__user__value__t_1a13c1682c4cebf14fd2c93cebae47fd8d" kindref="member">value</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7aee83104b716418ad425ca21763e9d405" kindref="member">encoder_status_init</ref>;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a8342ed5f95676336259b9626e5ab5eb9" kindref="member">init</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a8342ed5f95676336259b9626e5ab5eb9" kindref="member">init</ref>();</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a0976346978710ff6fb34a8cd238d0e4d" kindref="member">start_sample</ref>()<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5afd599380584e61bc8b2c41b132dbeeec" kindref="member">mcl_encoder_start_sample_error</ref>);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a4dae8342b13f1b93c6acddf91acd9692" kindref="member">mcl_user_delay_us</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a066dccd24e8c640bf343990b0803ade9" kindref="member">communication_interval_us</ref><sp/>*<sp/>2);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>((encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a40b1b524ee26367cdc34f82056863e09" kindref="member">get_theta</ref>(&amp;encoder-&gt;<ref refid="structmcl__encoder__t_1a7720be35e17863b8f008e6034ee431cf" kindref="member">theta_initial</ref>)<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>),<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a2fd33c10cc2c0f4c63de0414b9f458f8" kindref="member">mcl_encoder_get_theta_error</ref>);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a003cad4c5d94b397f961b8c64a5ea4f9" kindref="member">encoder_status_run</ref>;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a7f1892d84b694757b0bce7c05addb958" kindref="member">enable</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>;</highlight></codeline>
<codeline lineno="62"><highlight class="normal">}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/><ref refid="hpm__mcl__encoder_8c_1a0c0cb83fb5da4e216567125747517da0" kindref="member">hpm_mcl_encoder_start_sample</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder)</highlight></codeline>
<codeline lineno="65"><highlight class="normal">{</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>tick;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1af71b7be25cc98946e91545dec4a93ce3" kindref="member">MCL_ASSERT_EXEC_CODE_AND_RETURN_OPT</ref>(encoder<sp/>!=<sp/>NULL,<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a89be9003ae427ad246588980cd703d01" kindref="member">encoder_status_fail</ref>,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1aa1a87daee1af58e93c5aa4a32f793f5b" kindref="member">MCL_ASSERT_EXEC_CODE_AND_RETURN</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a0976346978710ff6fb34a8cd238d0e4d" kindref="member">start_sample</ref>()<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a89be9003ae427ad246588980cd703d01" kindref="member">encoder_status_fail</ref>,<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5afd599380584e61bc8b2c41b132dbeeec" kindref="member">mcl_encoder_start_sample_error</ref>);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1aa1a87daee1af58e93c5aa4a32f793f5b" kindref="member">MCL_ASSERT_EXEC_CODE_AND_RETURN</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a57259c85020b084de465c7787ec73e25" kindref="member">get_lead_tick</ref>(&amp;tick)<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a89be9003ae427ad246588980cd703d01" kindref="member">encoder_status_fail</ref>,<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a4a52a0febf45d55e95322eed15035c56" kindref="member">mcl_encoder_get_tick_error</ref>);</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1aa1a87daee1af58e93c5aa4a32f793f5b" kindref="member">MCL_ASSERT_EXEC_CODE_AND_RETURN</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a334169067bbe880edcc37af7b5024568" kindref="member">update_trig_lead_tick</ref>(tick)<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a89be9003ae427ad246588980cd703d01" kindref="member">encoder_status_fail</ref>,<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a8b781e73175ea13016617bbd270dd784" kindref="member">mcl_encoder_update_tick_error</ref>);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>;</highlight></codeline>
<codeline lineno="77"><highlight class="normal">}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/><ref refid="hpm__mcl__encoder_8c_1a488c3471f2d49a3565f9eab503472faa" kindref="member">hpm_mcl_encoder_set_initial_theta</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>theta)</highlight></codeline>
<codeline lineno="80"><highlight class="normal">{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder<sp/>!=<sp/>NULL,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>((encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>==<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a003cad4c5d94b397f961b8c64a5ea4f9" kindref="member">encoder_status_run</ref>),<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a52f18d0da8817aeec289c2e5d37f6b9c" kindref="member">mcl_encoder_not_ready</ref>);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a7720be35e17863b8f008e6034ee431cf" kindref="member">theta_initial</ref><sp/>=<sp/>theta;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>;</highlight></codeline>
<codeline lineno="85"><highlight class="normal">}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/><ref refid="hpm__mcl__encoder_8c_1a570404d74284f07ad4f0a671f58c6f6e" kindref="member">hpm_mcl_encoder_process</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder,<sp/>uint32_t<sp/>tick_deta)</highlight></codeline>
<codeline lineno="88"><highlight class="normal">{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ts;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>theta;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>speed;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>theta_forecast;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>theta_integrator;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>theta_delta;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/>status;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a7987628a9f9662f4891f49c739314062" kindref="member">MCL_ASSERT_OPT</ref>(encoder<sp/>!=<sp/>NULL,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(tick_deta<sp/>!=<sp/>0,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a5df83cb02f3d9deca64a321eca8158b9" kindref="member">mcl_invalid_argument</ref>);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>((encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>==<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a003cad4c5d94b397f961b8c64a5ea4f9" kindref="member">encoder_status_run</ref>),<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a52f18d0da8817aeec289c2e5d37f6b9c" kindref="member">mcl_encoder_not_ready</ref>);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1aa1a87daee1af58e93c5aa4a32f793f5b" kindref="member">MCL_ASSERT_EXEC_CODE_AND_RETURN</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a40b1b524ee26367cdc34f82056863e09" kindref="member">get_theta</ref>(&amp;theta)<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7a89be9003ae427ad246588980cd703d01" kindref="member">encoder_status_fail</ref>,<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a2fd33c10cc2c0f4c63de0414b9f458f8" kindref="member">mcl_encoder_get_theta_error</ref>);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a7f1892d84b694757b0bce7c05addb958" kindref="member">enable</ref><sp/>!=<sp/>NULL)<sp/>&amp;&amp;<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a7f1892d84b694757b0bce7c05addb958" kindref="member">enable</ref><sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta<sp/>=<sp/>*encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a9c5dc3fd47c7e9020ac36a197d36cf7c" kindref="member">theta</ref>;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(encoder-&gt;<ref refid="structmcl__encoder__t_1a151439c5499b569bcbe92028bec514f7" kindref="member">force_set_theta</ref>.<ref refid="structmcl__user__value__t_1abbb68a18f8ba945c402a8d34792639fc" kindref="member">enable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta<sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a151439c5499b569bcbe92028bec514f7" kindref="member">force_set_theta</ref>.<ref refid="structmcl__user__value__t_1a13c1682c4cebf14fd2c93cebae47fd8d" kindref="member">value</ref>;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta<sp/>=<sp/><ref refid="hpm__mcl__common_8h_1a2d3879a27c6198a449b63fcbbbbd9496" kindref="member">MCL_ANGLE_MOD_X</ref>(0,<sp/>2<sp/>*<sp/><ref refid="hpm__mcl__common_8h_1a990c966fff97d73cb5835a41156d6327" kindref="member">MCL_PI</ref>,<sp/>theta<sp/>-<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a7720be35e17863b8f008e6034ee431cf" kindref="member">theta_initial</ref>);</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a78ea4b8313d43543e74c693369cba547" kindref="member">speed_cal_method</ref>)<sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8h_1add0d8d359bdd218ea5cc5e2d3cf8a6b6abb15c589692e87efa72f4f8b97a00730" kindref="member">encoder_method_user</ref>:</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>status<sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1ade356bcdd6b141f637a0c22095d7582e" kindref="member">process_by_user</ref>(theta,<sp/>&amp;speed,<sp/>&amp;theta_forecast);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(status<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,<sp/>status);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8h_1add0d8d359bdd218ea5cc5e2d3cf8a6b6a8efef5d3ec0ccd64507387bf771ac441" kindref="member">encoder_method_m</ref>:</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ts<sp/>=<sp/>(float)tick_deta<sp/>/<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1a9faeb8989d212f9e0ffb05e601824db0" kindref="member">mcu_clock_tick</ref>);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta_delta<sp/>=<sp/><ref refid="hpm__mcl__common_8h_1a22809cd96f4b469411bbe9c7778bad93" kindref="member">MCL_GET_ANGLE_DELTA</ref>((theta<sp/>-<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a6d78beb4c62e80611546ccb6ee753542" kindref="member">m_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__function__t_1a4e18f22aaaf74e5d426f5bddfcce1b6f" kindref="member">theta_last</ref>),<sp/><ref refid="hpm__mcl__common_8h_1a6fce632c323de12d2a5a9cbe15534e69" kindref="member">MCL_2PI</ref>);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="hpm__mcl__math_8h_1ad3c8f7ca59f915b889ad9f6c913f165b" kindref="member">MCL_FLOAT_IS_ZERO</ref>(theta_delta))<sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a6d78beb4c62e80611546ccb6ee753542" kindref="member">m_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__function__t_1a63f04f5d30be54b4e7d3f1ef238a784c" kindref="member">ts_sigma</ref><sp/>+=<sp/>ts;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a6d78beb4c62e80611546ccb6ee753542" kindref="member">m_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__function__t_1a63f04f5d30be54b4e7d3f1ef238a784c" kindref="member">ts_sigma</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>theta_delta<sp/>/<sp/>ts;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a6d78beb4c62e80611546ccb6ee753542" kindref="member">m_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__function__t_1a63f04f5d30be54b4e7d3f1ef238a784c" kindref="member">ts_sigma</ref><sp/>&gt;=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a56558ba89ebd15691ac96eadcb76ce39" kindref="member">timeout_s</ref>)<sp/>{</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a6d78beb4c62e80611546ccb6ee753542" kindref="member">m_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__function__t_1a63f04f5d30be54b4e7d3f1ef238a784c" kindref="member">ts_sigma</ref><sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a56558ba89ebd15691ac96eadcb76ce39" kindref="member">timeout_s</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a6d78beb4c62e80611546ccb6ee753542" kindref="member">m_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__function__t_1a4e18f22aaaf74e5d426f5bddfcce1b6f" kindref="member">theta_last</ref><sp/>=<sp/>theta;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8h_1add0d8d359bdd218ea5cc5e2d3cf8a6b6aa7853ce78129968dec6e4cdb43acca59" kindref="member">encoder_method_t</ref>:</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ts<sp/>=<sp/>tick_deta<sp/>/<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1a9faeb8989d212f9e0ffb05e601824db0" kindref="member">mcu_clock_tick</ref>);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta_delta<sp/>=<sp/><ref refid="hpm__mcl__common_8h_1a22809cd96f4b469411bbe9c7778bad93" kindref="member">MCL_GET_ANGLE_DELTA</ref>((theta<sp/>-<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a49094834d4987a75172b9c92f23e956a" kindref="member">theta_last</ref>),<sp/><ref refid="hpm__mcl__common_8h_1a6fce632c323de12d2a5a9cbe15534e69" kindref="member">MCL_2PI</ref>);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a2005a1b058b3ab1977f1fd6bd1c10ab0" kindref="member">ts_sigma</ref><sp/>+=<sp/>ts;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="hpm__mcl__math_8h_1ad3c8f7ca59f915b889ad9f6c913f165b" kindref="member">MCL_FLOAT_IS_ZERO</ref>(theta_delta))<sp/>{</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a8cec92f27159fa5362d6043b6dcf575b" kindref="member">speed_last</ref>;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>theta_delta<sp/>/<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a2005a1b058b3ab1977f1fd6bd1c10ab0" kindref="member">ts_sigma</ref>;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a2005a1b058b3ab1977f1fd6bd1c10ab0" kindref="member">ts_sigma</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a2005a1b058b3ab1977f1fd6bd1c10ab0" kindref="member">ts_sigma</ref><sp/>&gt;=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a56558ba89ebd15691ac96eadcb76ce39" kindref="member">timeout_s</ref>)<sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a2005a1b058b3ab1977f1fd6bd1c10ab0" kindref="member">ts_sigma</ref><sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a56558ba89ebd15691ac96eadcb76ce39" kindref="member">timeout_s</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a49094834d4987a75172b9c92f23e956a" kindref="member">theta_last</ref><sp/>=<sp/>theta;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1a5605c8cdb2c5915db3b0eddf681b106d" kindref="member">t_method</ref>.<ref refid="structmcl__encoder__cal__speed__t__function__t_1a8cec92f27159fa5362d6043b6dcf575b" kindref="member">speed_last</ref><sp/>=<sp/>speed;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8h_1add0d8d359bdd218ea5cc5e2d3cf8a6b6af1ec93ee012994eaf993e1f8dfbf197f" kindref="member">encoder_method_m_t</ref>:</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ts<sp/>=<sp/>tick_deta<sp/>/<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1a9faeb8989d212f9e0ffb05e601824db0" kindref="member">mcu_clock_tick</ref>);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta_delta<sp/>=<sp/><ref refid="hpm__mcl__common_8h_1a22809cd96f4b469411bbe9c7778bad93" kindref="member">MCL_GET_ANGLE_DELTA</ref>((theta<sp/>-<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a78432d716c1fa0ad89f01ae122f3bf4f" kindref="member">theta_last</ref>),<sp/><ref refid="hpm__mcl__common_8h_1a6fce632c323de12d2a5a9cbe15534e69" kindref="member">MCL_2PI</ref>);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a325b0f6506b13fb7c793e15471213266" kindref="member">ts_sigma</ref><sp/>+=<sp/>ts;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a7f2ffdc08205252f9e14aa28edc1eed6" kindref="member">theta_sigma</ref><sp/>+=<sp/>theta_delta;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">)fabs((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a5a80037c557195774621277e1c33c3c1" kindref="member">speed_filter_last</ref>)<sp/>&gt;<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1aa7fccc79318d74c8d37880e3be4363fc" kindref="member">speed_abs_switch_m_t</ref>)<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a7f2ffdc08205252f9e14aa28edc1eed6" kindref="member">theta_sigma</ref><sp/>/<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a325b0f6506b13fb7c793e15471213266" kindref="member">ts_sigma</ref>;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a325b0f6506b13fb7c793e15471213266" kindref="member">ts_sigma</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a7f2ffdc08205252f9e14aa28edc1eed6" kindref="member">theta_sigma</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(theta<sp/>!=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a78432d716c1fa0ad89f01ae122f3bf4f" kindref="member">theta_last</ref>)<sp/>{</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a7f2ffdc08205252f9e14aa28edc1eed6" kindref="member">theta_sigma</ref><sp/>/<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a325b0f6506b13fb7c793e15471213266" kindref="member">ts_sigma</ref>;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a325b0f6506b13fb7c793e15471213266" kindref="member">ts_sigma</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a7f2ffdc08205252f9e14aa28edc1eed6" kindref="member">theta_sigma</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a25ab9aaa1c7a6491e615c2c0f5c34317" kindref="member">speed_last</ref>;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a25ab9aaa1c7a6491e615c2c0f5c34317" kindref="member">speed_last</ref><sp/>=<sp/>speed;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a78432d716c1fa0ad89f01ae122f3bf4f" kindref="member">theta_last</ref><sp/>=<sp/>theta;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8h_1add0d8d359bdd218ea5cc5e2d3cf8a6b6a943c9872ed17ffa925faa298aa21f3fb" kindref="member">encoder_method_pll</ref>:</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta_delta<sp/>=<sp/>sinf(theta)<sp/>*<sp/>cosf(encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1a453209c6da4d11d8074502debe9c5036" kindref="member">theta_last</ref>)<sp/>-<sp/>cosf(theta)<sp/>*<sp/>sinf(encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1a453209c6da4d11d8074502debe9c5036" kindref="member">theta_last</ref>);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1afe3bb871270247fc255f0e3d6e869c75" kindref="member">pi_integrator</ref><sp/>+=<sp/>theta_delta<sp/>*<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1a5f15458ac84f45836cc155915ba869e0" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoder__cal__speed__pll__cfg__t_1aae6c749575fa4aae15a3a68ff0921ef5" kindref="member">ki</ref>;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speed<sp/>=<sp/>theta_delta<sp/>*<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1a5f15458ac84f45836cc155915ba869e0" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoder__cal__speed__pll__cfg__t_1a5504c11f17f1e17b0b3c54612b7525d8" kindref="member">kp</ref><sp/>+<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1afe3bb871270247fc255f0e3d6e869c75" kindref="member">pi_integrator</ref>;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta_integrator<sp/>=<sp/>speed<sp/>*<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1ad66c660c7f0856cb47e76c1210cf699a" kindref="member">period_call_time_s</ref>)<sp/>+<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1a453209c6da4d11d8074502debe9c5036" kindref="member">theta_last</ref>;</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta_integrator<sp/>=<sp/><ref refid="hpm__mcl__common_8h_1a2d3879a27c6198a449b63fcbbbbd9496" kindref="member">MCL_ANGLE_MOD_X</ref>(0,<sp/>2<sp/>*<sp/><ref refid="hpm__mcl__common_8h_1a990c966fff97d73cb5835a41156d6327" kindref="member">MCL_PI</ref>,<sp/>theta_integrator);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1ad8cdba924048886d5e60062b4fc4321f" kindref="member">pll_method</ref>.<ref refid="structmcl__encoder__cal__speed__pll__function__t_1a453209c6da4d11d8074502debe9c5036" kindref="member">theta_last</ref><sp/>=<sp/>theta_integrator;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a5df83cb02f3d9deca64a321eca8158b9" kindref="member">mcl_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>speed<sp/>=<sp/><ref refid="hpm__mcl__filter_8c_1a2acfcbb9d64faac619b31ae9901f9491" kindref="member">hpm_mcl_filter_iir_df1</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a06e658718f9935ac990b5147a023359d" kindref="member">iirfilter</ref>,<sp/>speed);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>theta<sp/>=<sp/><ref refid="hpm__mcl__common_8h_1a2d3879a27c6198a449b63fcbbbbd9496" kindref="member">MCL_ANGLE_MOD_X</ref>(0,<sp/>2<sp/>*<sp/><ref refid="hpm__mcl__common_8h_1a990c966fff97d73cb5835a41156d6327" kindref="member">MCL_PI</ref>,<sp/>theta<sp/>*<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1ac1b0cf668ab44768481e6a83f1922914" kindref="member">pole_num</ref>));</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>theta_forecast<sp/>=<sp/><ref refid="hpm__mcl__common_8h_1a2d3879a27c6198a449b63fcbbbbd9496" kindref="member">MCL_ANGLE_MOD_X</ref>(0,<sp/>2<sp/>*<sp/><ref refid="hpm__mcl__common_8h_1a990c966fff97d73cb5835a41156d6327" kindref="member">MCL_PI</ref>,<sp/>theta<sp/>+<sp/>speed<sp/>*<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1af9a069250edf1a130b084e51b5ac3036" kindref="member">current_loop_ts</ref>)<sp/>*<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1ac1b0cf668ab44768481e6a83f1922914" kindref="member">pole_num</ref>));</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a9c5dc3fd47c7e9020ac36a197d36cf7c" kindref="member">theta</ref><sp/>=<sp/>theta;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a8513acffbbee1b172a7ab305d0c93bad" kindref="member">speed</ref><sp/>=<sp/>speed;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a0c5a02541b3e214eb74510cf353887bb" kindref="member">theta_forecast</ref><sp/>=<sp/>theta_forecast;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a87d4561df84fca2cc02c2a9f9a919732" kindref="member">cal_speed</ref>.<ref refid="structmcl__encoder__t_1aa1d4e76186ba90cdaeb7acb095b9680d" kindref="member">m_t_method</ref>.<ref refid="structmcl__encoder__cal__speed__m__t__function__t_1a5a80037c557195774621277e1c33c3c1" kindref="member">speed_filter_last</ref><sp/>=<sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a8513acffbbee1b172a7ab305d0c93bad" kindref="member">speed</ref>;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>;</highlight></codeline>
<codeline lineno="192"><highlight class="normal">}</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/><ref refid="hpm__mcl__encoder_8c_1ae5fb00ae11775e198b3006df7c219504" kindref="member">hpm_mcl_encoder_set_status</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder,<sp/><ref refid="hpm__mcl__encoder_8h_1ada292d0bcc6c9a8bb5ffd264f3f572c7" kindref="member">mcl_encoder_status_t</ref><sp/>status)</highlight></codeline>
<codeline lineno="195"><highlight class="normal">{</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder<sp/>!=<sp/>NULL,<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a6f9d895ded2188352dee8b236c5e3c37" kindref="member">mcl_invalid_pointer</ref>);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a8373397bd0328dc01be97d6cbcd3b291" kindref="member">status</ref><sp/>=<sp/>status;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>;</highlight></codeline>
<codeline lineno="199"><highlight class="normal">}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8c_1a850d2f8593c93fdd6110defd602459c7" kindref="member">hpm_mcl_encoder_force_theta</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>theta,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>enable)</highlight></codeline>
<codeline lineno="202"><highlight class="normal">{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a151439c5499b569bcbe92028bec514f7" kindref="member">force_set_theta</ref>.<ref refid="structmcl__user__value__t_1abbb68a18f8ba945c402a8d34792639fc" kindref="member">enable</ref><sp/>=<sp/>enable;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a151439c5499b569bcbe92028bec514f7" kindref="member">force_set_theta</ref>.<ref refid="structmcl__user__value__t_1a13c1682c4cebf14fd2c93cebae47fd8d" kindref="member">value</ref><sp/>=<sp/>theta;</highlight></codeline>
<codeline lineno="205"><highlight class="normal">}</highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8c_1ae52331fddf8b6b71707c5b21c31bad6e" kindref="member">hpm_mcl_encoder_get_raw_theta</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder)</highlight></codeline>
<codeline lineno="208"><highlight class="normal">{</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>theta;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a40b1b524ee26367cdc34f82056863e09" kindref="member">get_theta</ref>(&amp;theta)<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,<sp/>-<ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1a4ca0aba09b0cbf341e61c096cfafeb4c" kindref="member">mcl_fail</ref>);</highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>theta;</highlight></codeline>
<codeline lineno="214"><highlight class="normal">}</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8c_1a2dd59824fc0a0751c697088158e0e5e0" kindref="member">hpm_mcl_encoder_get_theta</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder)</highlight></codeline>
<codeline lineno="217"><highlight class="normal">{</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a7f1892d84b694757b0bce7c05addb958" kindref="member">enable</ref><sp/>!=<sp/>NULL)<sp/>&amp;&amp;<sp/>(*encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a7f1892d84b694757b0bce7c05addb958" kindref="member">enable</ref><sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a9c5dc3fd47c7e9020ac36a197d36cf7c" kindref="member">theta</ref>;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a9c5dc3fd47c7e9020ac36a197d36cf7c" kindref="member">theta</ref>;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="223"><highlight class="normal">}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8c_1ae13b8fb0b56887159f269458f0e004be" kindref="member">hpm_mcl_encoder_get_sensorless_theta</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder)</highlight></codeline>
<codeline lineno="226"><highlight class="normal">{</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*encoder-&gt;<ref refid="structmcl__encoder__t_1a66d7f2122a7eb6ac52e586a0db8342b2" kindref="member">sensorless</ref>.<ref refid="structmcl__encoder__t_1a9c5dc3fd47c7e9020ac36a197d36cf7c" kindref="member">theta</ref>;</highlight></codeline>
<codeline lineno="228"><highlight class="normal">}</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8c_1a7a6b6bc0edcb28692798f6950ef3f223" kindref="member">hpm_mcl_encoder_get_speed</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder)</highlight></codeline>
<codeline lineno="231"><highlight class="normal">{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a8513acffbbee1b172a7ab305d0c93bad" kindref="member">speed</ref>;</highlight></codeline>
<codeline lineno="233"><highlight class="normal">}</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__encoder_8c_1a4ad192a198270565a6cb71e1fd8d9f67" kindref="member">hpm_mcl_encoder_get_forecast_theta</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder)</highlight></codeline>
<codeline lineno="236"><highlight class="normal">{</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>encoder-&gt;<ref refid="structmcl__encoder__t_1a830d41e562717ab4d1d7ebcf43cacaef" kindref="member">result</ref>.<ref refid="structmcl__encoder__t_1a0c5a02541b3e214eb74510cf353887bb" kindref="member">theta_forecast</ref>;</highlight></codeline>
<codeline lineno="238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/><ref refid="hpm__mcl__encoder_8c_1adc0e5b4f2d1fa7d929c49edbde81db6f" kindref="member">hpm_mcl_encoder_get_absolute_theta</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*theta)</highlight></codeline>
<codeline lineno="241"><highlight class="normal">{</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1aec7db91cfccfda9de871cb40fe145696" kindref="member">get_absolute_theta</ref>(theta)<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a2fd33c10cc2c0f4c63de0414b9f458f8" kindref="member">mcl_encoder_get_theta_error</ref>);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>;</highlight></codeline>
<codeline lineno="244"><highlight class="normal">}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><ref refid="hpm__mcl__common_8h_1a572fcb9d78561a8859565bac839c49b1" kindref="member">hpm_mcl_stat_t</ref><sp/><ref refid="hpm__mcl__encoder_8c_1a4b3eb72f466cba80de2d95ef9c798246" kindref="member">hpm_mcl_encoder_get_uvw_status</ref>(<ref refid="structmcl__encoder__t" kindref="compound">mcl_encoder_t</ref><sp/>*encoder,<sp/><ref refid="structmcl__encoder__uvw__level__t" kindref="compound">mcl_encoder_uvw_level_t</ref><sp/>*level)</highlight></codeline>
<codeline lineno="247"><highlight class="normal">{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__mcl__common_8h_1a64c8542a95d705232b451f0a128a0a35" kindref="member">MCL_ASSERT</ref>(encoder-&gt;<ref refid="structmcl__encoder__t_1a764be6bbaffdb2fa58b3462061514bb5" kindref="member">cfg</ref>-&gt;<ref refid="structmcl__encoer__cfg__t_1a37a7162b57c8498f5cc544bc540e7176" kindref="member">callback</ref>.<ref refid="structmcl__encoder__callback_1a5ea23bd90d86e7f363f1b165a170d161" kindref="member">get_uvw_level</ref>(level)<sp/>==<sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>,<sp/><ref refid="hpm__mcl__encoder_8h_1ab6a3e1c048f5b6cd325a663301406df5a5e1dd1aa4446e881584a299a4dd55f46" kindref="member">mcl_encoder_get_uvw_error</ref>);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="hpm__mcl__common_8h_1afe265cd19c5ca0690fdd800fe57288c1abc4f3cbeacf07a9c01bca3ddb79e79dd" kindref="member">mcl_success</ref>;</highlight></codeline>
<codeline lineno="250"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="middleware/hpm_mcl_v2/core/sensor/hpm_mcl_encoder.c"/>
  </compounddef>
</doxygen>
