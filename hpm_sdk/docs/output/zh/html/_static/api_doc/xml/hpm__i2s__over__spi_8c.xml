<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="hpm__i2s__over__spi_8c" kind="file" language="C++">
    <compoundname>hpm_i2s_over_spi.c</compoundname>
    <includes refid="hpm__i2s__over__spi_8h" local="yes">hpm_i2s_over_spi.h</includes>
    <includes refid="hpm__spi_8h" local="yes">hpm_spi.h</includes>
    <includes local="yes">hpm_clock_drv.h</includes>
    <incdepgraph>
      <node id="24">
        <label>hpm_l1c_drv.h</label>
        <link refid="hpm__l1c__drv_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>riscv/riscv_core.h</label>
        <link refid="riscv__core_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>hpm_dma_mgr.h</label>
        <link refid="hpm__dma__mgr_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>components/i2s_over_spi/hpm_i2s_over_spi.c</label>
        <link refid="hpm__i2s__over__spi_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>hpm_i2s_over_spi.h</label>
        <link refid="hpm__i2s__over__spi_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>hpm_spi.h</label>
        <link refid="hpm__spi_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>hpm_common.h</label>
        <link refid="hpm__common_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>hpm_csr_drv.h</label>
        <link refid="hpm__csr__drv_8h"/>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>hpm_dma_drv.h</label>
        <link refid="hpm__dma__drv_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>hpm_dmamux_drv.h</label>
        <link refid="hpm__dmamux__drv_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>hpm_gptmr_drv.h</label>
        <link refid="hpm__gptmr__drv_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>hpm_i2s_common.h</label>
        <link refid="hpm__i2s__common_8h"/>
      </node>
      <node id="13">
        <label>hpm_spi_drv.h</label>
        <link refid="hpm__spi__drv_8h"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>assert.h</label>
      </node>
      <node id="15">
        <label>hpm_clock_drv.h</label>
      </node>
      <node id="26">
        <label>hpm_csr_regs.h</label>
      </node>
      <node id="21">
        <label>hpm_dma_regs.h</label>
      </node>
      <node id="18">
        <label>hpm_dmamux_regs.h</label>
      </node>
      <node id="19">
        <label>hpm_dmamux_src.h</label>
      </node>
      <node id="11">
        <label>hpm_gptmr_regs.h</label>
      </node>
      <node id="23">
        <label>hpm_misc.h</label>
      </node>
      <node id="12">
        <label>hpm_soc_feature.h</label>
      </node>
      <node id="14">
        <label>hpm_spi_regs.h</label>
      </node>
      <node id="5">
        <label>stdbool.h</label>
      </node>
      <node id="6">
        <label>stdint.h</label>
      </node>
      <node id="8">
        <label>stdlib.h</label>
      </node>
      <node id="7">
        <label>string.h</label>
      </node>
    </incdepgraph>
    <sectiondef kind="func">
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a622b2eb58c856444711d7b94eff589b2" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>static hpm_stat_t i2s_clocks_init</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s, uint32_t lrck_hz, uint32_t audio_depth, uint32_t size)</argsstring>
        <name>i2s_clocks_init</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>lrck_hz</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>audio_depth</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="314" column="19" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="314" bodyend="388" declfile="components/i2s_over_spi/hpm_i2s_over_spi.c" declline="12" declcolumn="19"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a2265491427162bd9d1f166436ec3f008" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>static hpm_stat_t hpm_i2s_master_over_spi_tx_config</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s, uint8_t protocol, uint32_t lrck_hz, uint32_t audio_depth, uint32_t size)</argsstring>
        <name>hpm_i2s_master_over_spi_tx_config</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>protocol</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>lrck_hz</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>audio_depth</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="299" column="19" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="299" bodyend="312" declfile="components/i2s_over_spi/hpm_i2s_over_spi.c" declline="13" declcolumn="19"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a109fa2fe0e08cee67c009b5e17ff4888" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void hpm_i2s_master_over_spi_transfer_complete_callback</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s)</argsstring>
        <name>hpm_i2s_master_over_spi_transfer_complete_callback</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <briefdescription>
<para>Transfer complete callback for i2s master over spi. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="15" column="6" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="15" bodyend="40"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a8a8846c5aa8ddadf06744708eea4e610" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>hpm_stat_t hpm_i2s_master_over_spi_init</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s)</argsstring>
        <name>hpm_i2s_master_over_spi_init</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <briefdescription>
<para>Initialization for i2s master over spi. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>status_success</parametername>
</parameternamelist>
<parameterdescription>
<para>if no error occurred </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="42" column="12" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="42" bodyend="58"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a17035b1c530ba94ffcaca425f1e0e63d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool hpm_i2s_master_over_spi_tx_is_busy</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s)</argsstring>
        <name>hpm_i2s_master_over_spi_tx_is_busy</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <briefdescription>
<para>Check if i2s master over spiis busy. </para>
        </briefdescription>
        <detaileddescription>
<para>This function determines whether the I2S-over-SPI master device is currently busy transmitting data. It is typically used during I2S communication to ensure that the device is not processing data, thus avoiding data conflicts or overwriting.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Returns a bool value indicating the transmission status of the I2S-over-SPI master device. Returns true if the device is busy, and false if the device is idle. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="60" column="6" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="60" bodyend="63"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1af9442a7393887eab1152eae07c915917" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>hpm_stat_t hpm_i2s_master_over_spi_tx_stop</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s)</argsstring>
        <name>hpm_i2s_master_over_spi_tx_stop</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <briefdescription>
<para>Stop Transmission for i2s master over spi. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>status_success</parametername>
</parameternamelist>
<parameterdescription>
<para>if no error occurred </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="65" column="12" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="65" bodyend="82"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1afd9ba0726ec74a9e7558baef72fb9554" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>hpm_stat_t hpm_i2s_master_over_spi_tx_buffer_nonblocking</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s, uint8_t protocol, uint32_t lrck_hz, uint8_t audio_depth, uint8_t *data, uint32_t size)</argsstring>
        <name>hpm_i2s_master_over_spi_tx_buffer_nonblocking</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>protocol</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>lrck_hz</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>audio_depth</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Transmit for i2s master over spi in a non-blocking.</para>
<para>This function initializes and starts a transmission operation to send audio data to an I2S Over SPI master mode device via the SPI interface without blocking the current execution flow until the transfer is complete.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>protocol</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s protocol, only support I2S_PROTOCOL_MSB_JUSTIFIED I2S_PROTOCOL_LSB_JUSTIFIED </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>lrck_hz</parametername>
</parameternamelist>
<parameterdescription>
<para>switch left and right channels frequency, unit: hz </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>audio_depth</parametername>
</parameternamelist>
<parameterdescription>
<para>audio depth only support 16bits and 32bits </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the audio data to be transmitted. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>size</parametername>
</parameternamelist>
<parameterdescription>
<para>Total size of the audio data to be transmitted in bytes.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>status_success if no error occurred </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="84" column="12" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="84" bodyend="132"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a2d9d6e700c67e653eaac4c250610f741" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>hpm_stat_t hpm_i2s_master_over_spi_tx_buffer</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s, uint8_t protocol, uint32_t lrck_hz, uint8_t audio_depth, uint8_t *data, uint32_t size)</argsstring>
        <name>hpm_i2s_master_over_spi_tx_buffer</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>protocol</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>lrck_hz</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>audio_depth</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>data</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
<para>Transmit for i2s master over spi. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">protocol</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s protocol, only support I2S_PROTOCOL_MSB_JUSTIFIED I2S_PROTOCOL_LSB_JUSTIFIED </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">lrck_hz</parametername>
</parameternamelist>
<parameterdescription>
<para>switch left and right channels frequency, unit: hz </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">audio_depth</parametername>
</parameternamelist>
<parameterdescription>
<para>audio depth only support 16bits and 32bits </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">data</parametername>
</parameternamelist>
<parameterdescription>
<para>data pointer </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">size</parametername>
</parameternamelist>
<parameterdescription>
<para>transmit size</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>status_success</parametername>
</parameternamelist>
<parameterdescription>
<para>if no error occurred </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="134" column="12" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="134" bodyend="196"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a0e403e52592e5cb9a93c3c67173879ef" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>hpm_stat_t hpm_i2s_master_over_spi_rx_config</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s, uint8_t protocol, uint32_t lrck_hz, uint32_t audio_depth, uint8_t *buffer0, uint8_t *buffer1, uint32_t size)</argsstring>
        <name>hpm_i2s_master_over_spi_rx_config</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>protocol</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>lrck_hz</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>audio_depth</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>buffer0</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>buffer1</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
<para>Receiving configuration for i2s master over spi. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">protocol</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s protocol, only support I2S_PROTOCOL_MSB_JUSTIFIED I2S_PROTOCOL_LSB_JUSTIFIED </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">lrck_hz</parametername>
</parameternamelist>
<parameterdescription>
<para>switch left and right channels frequency, unit: hz </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">audio_depth</parametername>
</parameternamelist>
<parameterdescription>
<para>audio depth only support 16bits and 32bits </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">buffer0</parametername>
</parameternamelist>
<parameterdescription>
<para>buffer0 pointer </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">buffer1</parametername>
</parameternamelist>
<parameterdescription>
<para>buffer1 pointer </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">size</parametername>
</parameternamelist>
<parameterdescription>
<para>receive size</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>status_success</parametername>
</parameternamelist>
<parameterdescription>
<para>if no error occurred </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="198" column="12" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="198" bodyend="258"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a7e4246f1510bc5a046c728d78a064a16" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>hpm_stat_t hpm_i2s_master_over_spi_rx_start</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s, i2s_rx_data_tc callback)</argsstring>
        <name>hpm_i2s_master_over_spi_rx_start</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1ab47745e0fc578dbef2e50018ca9f68f0" kindref="member">i2s_rx_data_tc</ref></type>
          <declname>callback</declname>
        </param>
        <briefdescription>
<para>Start receiving for i2s master over spi. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">callback</parametername>
</parameternamelist>
<parameterdescription>
<para>callback after each buffer is received</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>status_success</parametername>
</parameternamelist>
<parameterdescription>
<para>if no error occurred </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="260" column="12" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="260" bodyend="277"/>
      </memberdef>
      <memberdef kind="function" id="hpm__i2s__over__spi_8c_1a9f47246ce5b13162fbcd579810cc19fa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref></type>
        <definition>hpm_stat_t hpm_i2s_master_over_spi_rx_stop</definition>
        <argsstring>(hpm_i2s_over_spi_t *i2s)</argsstring>
        <name>hpm_i2s_master_over_spi_rx_stop</name>
        <param>
          <type><ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref> *</type>
          <declname>i2s</declname>
        </param>
        <briefdescription>
<para>Stop receiving for i2s master over spi. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">i2s</parametername>
</parameternamelist>
<parameterdescription>
<para>i2s over spi context</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername>status_success</parametername>
</parameternamelist>
<parameterdescription>
<para>if no error occurred </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/i2s_over_spi/hpm_i2s_over_spi.c" line="279" column="12" bodyfile="components/i2s_over_spi/hpm_i2s_over_spi.c" bodystart="279" bodyend="297"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2024<sp/>HPMicro</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>SPDX-License-Identifier:<sp/>BSD-3-Clause</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="hpm__i2s__over__spi_8h" kindref="compound">hpm_i2s_over_spi.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="hpm__spi_8h" kindref="compound">hpm_spi.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hpm_clock_drv.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a622b2eb58c856444711d7b94eff589b2" kindref="member">i2s_clocks_init</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/>uint32_t<sp/>lrck_hz,<sp/>uint32_t<sp/>audio_depth,<sp/>uint32_t<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a2265491427162bd9d1f166436ec3f008" kindref="member">hpm_i2s_master_over_spi_tx_config</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/>uint8_t<sp/>protocol,<sp/>uint32_t<sp/>lrck_hz,<sp/>uint32_t<sp/>audio_depth,<sp/>uint32_t<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="hpm__i2s__over__spi_8c_1a109fa2fe0e08cee67c009b5e17ff4888" kindref="member">hpm_i2s_master_over_spi_transfer_complete_callback</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s)</highlight></codeline>
<codeline lineno="16"><highlight class="normal">{</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>addr;</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>channel;</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structhpm__i2s__gptmr__context__t" kindref="compound">hpm_i2s_gptmr_context_t</ref><sp/>*transfer_time<sp/>=<sp/>&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="group__gptmr__interface_1ga180f9b95070865bc10c7de7808b9ea88" kindref="member">gptmr_check_status</ref>(transfer_time-&gt;<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/><ref refid="group__gptmr__interface_1gab1fc7dd2b978fa48e351bc1ab8370e9d" kindref="member">GPTMR_CH_RLD_STAT_MASK</ref>(transfer_time-&gt;<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>)))<sp/>{</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf778a64bdd6cf80356c08b3dedf4fc5b" kindref="member">gptmr_clear_status</ref>(transfer_time-&gt;<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/><ref refid="group__gptmr__interface_1gab1fc7dd2b978fa48e351bc1ab8370e9d" kindref="member">GPTMR_CH_RLD_STAT_MASK</ref>(transfer_time-&gt;<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>));</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a034ba286743fd52314032e18105969e6" kindref="member">i2s_rx</ref><sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1acdfd03954b8602c6b460c2a078ac3136" kindref="member">rx_callback</ref>)<sp/>{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel<sp/>=<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>-&gt;channel;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>addr<sp/>=<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>-&gt;base-&gt;CHCTRL[channel].LLPOINTER;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a22e5ccb0d335d2c971048757c5c9fc2e" kindref="member">descriptors</ref>)<sp/>==<sp/>addr)<sp/>{</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1acdfd03954b8602c6b460c2a078ac3136" kindref="member">rx_callback</ref>(0);</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1acdfd03954b8602c6b460c2a078ac3136" kindref="member">rx_callback</ref>(1);</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a05f225468a8d78e2032d3d4dafe53d62" kindref="member">has_done</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafc4c41011fc6725c7883fd38270de74c" kindref="member">gptmr_disable_irq</ref>(transfer_time-&gt;<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/><ref refid="group__gptmr__interface_1gaaf1fc6b5889cb5dbb84cd4ec1fcb3e59" kindref="member">GPTMR_CH_RLD_IRQ_MASK</ref>(transfer_time-&gt;<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>));</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="40"><highlight class="normal">}</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a8a8846c5aa8ddadf06744708eea4e610" kindref="member">hpm_i2s_master_over_spi_init</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s)</highlight></codeline>
<codeline lineno="43"><highlight class="normal">{</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/>stat<sp/>=<sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structspi__initialize__config__t" kindref="compound">spi_initialize_config_t</ref><sp/>spi_config;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a33d3df7cd7344ed2f7bd6786b110218c" kindref="member">transfer_complete</ref><sp/>=<sp/><ref refid="hpm__i2s__over__spi_8c_1a109fa2fe0e08cee67c009b5e17ff4888" kindref="member">hpm_i2s_master_over_spi_transfer_complete_callback</ref>;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__spi_8c_1a92749b87848c44cdf2f7e05cd72baf13" kindref="member">hpm_spi_get_default_init_config</ref>(&amp;spi_config);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/>spi_config.<ref refid="structspi__initialize__config__t_1a3846994ed05be651c5f0e3f3284e6e5b" kindref="member">clk_phase</ref><sp/>=<sp/><ref refid="group__spi__interface_1ggab063d70616d6d55c73b01e9a1d2fb162adfa02e88e6f8e2e588681d72e7ec0740" kindref="member">spi_sclk_sampling_odd_clk_edges</ref>;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/>spi_config.<ref refid="structspi__initialize__config__t_1af647f14f4f4721f8375d67ea0aaee5b7" kindref="member">clk_polarity</ref><sp/>=<sp/><ref refid="group__spi__interface_1ggaa216e00c4ce27ab3897a36c72e617968a6a05e63978b1c909f29fcd9e0afe2739" kindref="member">spi_sclk_low_idle</ref>;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/>spi_config.<ref refid="structspi__initialize__config__t_1ae4d480b562f4e14812815edd0c65c052" kindref="member">data_len</ref><sp/>=<sp/>32;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/>spi_config.<ref refid="structspi__initialize__config__t_1a6c638f1ccc49b4a5473f26259fadeaea" kindref="member">direction</ref><sp/>=<sp/><ref refid="group__spi__interface_1ggaa68518c16202382c2e1f1c7c66a9d53dac8c28b25e0dd1ca37ffe2a9fcb691550" kindref="member">spi_msb_first</ref>;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/>spi_config.<ref refid="structspi__initialize__config__t_1a36024fa308c25c04377cd1f45873d1a5" kindref="member">mode</ref><sp/>=<sp/><ref refid="group__spi__interface_1gga9ac2dd2dcd0b2c3b5fb1363eac489a3ea6d237dd86032fe3495c45320e9ba4afb" kindref="member">spi_slave_mode</ref>;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="hpm__spi_8c_1a926606c43a217dca6c6afad012649427" kindref="member">hpm_spi_initialize</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/>&amp;spi_config);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="58"><highlight class="normal">}</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="hpm__i2s__over__spi_8c_1a17035b1c530ba94ffcaca425f1e0e63d" kindref="member">hpm_i2s_master_over_spi_tx_is_busy</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s)</highlight></codeline>
<codeline lineno="61"><highlight class="normal">{</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a05f225468a8d78e2032d3d4dafe53d62" kindref="member">has_done</ref><sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>?<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="63"><highlight class="normal">}</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1af9442a7393887eab1152eae07c915917" kindref="member">hpm_i2s_master_over_spi_tx_stop</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s)</highlight></codeline>
<codeline lineno="66"><highlight class="normal">{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i2s<sp/>==<sp/>NULL)<sp/>||<sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL)<sp/>||<sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a3308a6573d3e8733ff6236d414ebcf65" kindref="member">write_cs</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1ada8fe284a5391397106a3e2d41ddba68" kindref="member">cs_pin</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="82"><highlight class="normal">}</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1afd9ba0726ec74a9e7558baef72fb9554" kindref="member">hpm_i2s_master_over_spi_tx_buffer_nonblocking</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/>uint8_t<sp/>protocol,<sp/>uint32_t<sp/>lrck_hz,<sp/>uint8_t<sp/>audio_depth,<sp/>uint8_t<sp/>*data,<sp/>uint32_t<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>)</highlight></codeline>
<codeline lineno="85"><highlight class="normal">{</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8h_1a219e66052c4c274fcf81bcc2f77652e4" kindref="member">dma_mgr_chn_conf_t</ref><sp/>chg_config;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>data_width;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/>stat;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="hpm__i2s__over__spi_8c_1a2265491427162bd9d1f166436ec3f008" kindref="member">hpm_i2s_master_over_spi_tx_config</ref>(i2s,<sp/>protocol,<sp/>lrck_hz,<sp/>audio_depth,<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>!=<sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>)<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a05f225468a8d78e2032d3d4dafe53d62" kindref="member">has_done</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(audio_depth<sp/>==<sp/>16U)<sp/>{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a372c1d975c39d4c6bf64ba13973900d3" kindref="member">DMA_MGR_TRANSFER_WIDTH_HALF_WORD</ref>;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__spi__interface_1gaa4cff3b8b0cb8f5bf03c36e69d5ee5bb" kindref="member">spi_set_data_bits</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/>16);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a6c95497847a0e4fcdd06f58699100006" kindref="member">DMA_MGR_TRANSFER_WIDTH_WORD</ref>;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__spi__interface_1gaa4cff3b8b0cb8f5bf03c36e69d5ee5bb" kindref="member">spi_set_data_bits</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/>32);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref><sp/>/<sp/>(1<sp/>&lt;&lt;<sp/>data_width))<sp/>&gt;<sp/><ref refid="HPM5300_2HPM5301_2hpm__soc__feature_8h_1a9ab6af43398ba35709ba46f496487bc5" kindref="member">SPI_SOC_TRANSFER_COUNT_MAX</ref>)<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a034ba286743fd52314032e18105969e6" kindref="member">i2s_rx</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__spi_8c_1aed8707ac71bf311625d7eb709b18f20c" kindref="member">hpm_spi_transmit_setup_dma</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*spi<sp/>tx<sp/>data<sp/>dma*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a6fa7c7a09d860dd39bfc697dc86b8805" kindref="member">dma_mgr_get_default_chn_config</ref>(&amp;chg_config);</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac303c1f78599127bfd07a5521b043d96" kindref="member">src_mode</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1aa6dbf20840d2626367b1004f62ebed94" kindref="member">DMA_MGR_HANDSHAKE_MODE_NORMAL</ref>;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1abf3c7490a04d741952f14117c0c219ca" kindref="member">src_width</ref><sp/>=<sp/>data_width;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac01d4358e7b04bd3a475761e065faa33" kindref="member">src_addr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)data);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a3b847bbfd4476ca8b9b21262c038e40a" kindref="member">src_addr_ctrl</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1acd3e64e6a97e8b07eb8ce75f78519db2" kindref="member">DMA_MGR_ADDRESS_CONTROL_INCREMENT</ref>;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ab573d54934a8be3099437c5f2acb0311" kindref="member">dst_addr_ctrl</ref><sp/>=<sp/><ref refid="group__dma__interface_1gadec283cc248f55399685c1f27b2bcc08" kindref="member">DMA_ADDRESS_CONTROL_FIXED</ref>;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a54a6d295af50ab705a6ecd6371d6893f" kindref="member">dst_mode</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a20c3bf11dfdafef0b1c54d1f1da18676" kindref="member">DMA_MGR_HANDSHAKE_MODE_HANDSHAKE</ref>;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac279789f91bdd9945aad4e7d31495303" kindref="member">dst_addr</ref><sp/>=<sp/>(uint32_t)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>-&gt;<ref refid="structSPI__Type_1a63fce340a6d0378668d55df1e5c2dc99" kindref="member">DATA</ref>;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a055cf9ef45e9b7868f53821997a40297" kindref="member">dst_width</ref><sp/>=<sp/>data_width;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a02caa298cdd484fca1177cf515c3f1fb" kindref="member">en_dmamux</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a1f3e6087105526e53e49f1323a987e34" kindref="member">dmamux_src</ref><sp/>=<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1acb17e7eedcb0bd90de32fa0731624f16" kindref="member">txdma_src</ref>;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a3e26dd2c69e6087d35b1d117da10fe42" kindref="member">priority</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1acbbc9802cb005ba71f465efb031e871e" kindref="member">DMA_MGR_CHANNEL_PRIORITY_HIGH</ref>;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a868bb43bbed23e7b959793a41a2295c4" kindref="member">size_in_byte</ref><sp/>=<sp/>(<ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref><sp/>&lt;&lt;<sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1abf3c7490a04d741952f14117c0c219ca" kindref="member">src_width</ref>)<sp/>&gt;&gt;<sp/>data_width;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a978e7e2f4e8e9b342de6a43d6975ff5b" kindref="member">dma_mgr_setup_channel</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a97ad488075d47df744a1ba65bce30b29" kindref="member">tx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>,<sp/>&amp;chg_config);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a66418c75052465b695b7fe6cc54ecf5a" kindref="member">dma_mgr_enable_channel</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a97ad488075d47df744a1ba65bce30b29" kindref="member">tx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>);</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a3308a6573d3e8733ff6236d414ebcf65" kindref="member">write_cs</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1ada8fe284a5391397106a3e2d41ddba68" kindref="member">cs_pin</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga562215822bb5267cc54accab7c737c0f" kindref="member">gptmr_enable_irq</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/><ref refid="group__gptmr__interface_1gaaf1fc6b5889cb5dbb84cd4ec1fcb3e59" kindref="member">GPTMR_CH_RLD_IRQ_MASK</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>));</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="132"><highlight class="normal">}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a2d9d6e700c67e653eaac4c250610f741" kindref="member">hpm_i2s_master_over_spi_tx_buffer</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/>uint8_t<sp/>protocol,<sp/>uint32_t<sp/>lrck_hz,<sp/>uint8_t<sp/>audio_depth,<sp/>uint8_t<sp/>*data,<sp/>uint32_t<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>)</highlight></codeline>
<codeline lineno="135"><highlight class="normal">{</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8h_1a219e66052c4c274fcf81bcc2f77652e4" kindref="member">dma_mgr_chn_conf_t</ref><sp/>chg_config;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>data_width;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/>stat;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="hpm__i2s__over__spi_8c_1a2265491427162bd9d1f166436ec3f008" kindref="member">hpm_i2s_master_over_spi_tx_config</ref>(i2s,<sp/>protocol,<sp/>lrck_hz,<sp/>audio_depth,<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>!=<sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>)<sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a05f225468a8d78e2032d3d4dafe53d62" kindref="member">has_done</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(audio_depth<sp/>==<sp/>16U)<sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a372c1d975c39d4c6bf64ba13973900d3" kindref="member">DMA_MGR_TRANSFER_WIDTH_HALF_WORD</ref>;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__spi__interface_1gaa4cff3b8b0cb8f5bf03c36e69d5ee5bb" kindref="member">spi_set_data_bits</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/>16);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a6c95497847a0e4fcdd06f58699100006" kindref="member">DMA_MGR_TRANSFER_WIDTH_WORD</ref>;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__spi__interface_1gaa4cff3b8b0cb8f5bf03c36e69d5ee5bb" kindref="member">spi_set_data_bits</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/>32);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref><sp/>/<sp/>(1<sp/>&lt;&lt;<sp/>data_width))<sp/>&gt;<sp/><ref refid="HPM5300_2HPM5301_2hpm__soc__feature_8h_1a9ab6af43398ba35709ba46f496487bc5" kindref="member">SPI_SOC_TRANSFER_COUNT_MAX</ref>)<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a034ba286743fd52314032e18105969e6" kindref="member">i2s_rx</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__spi_8c_1aed8707ac71bf311625d7eb709b18f20c" kindref="member">hpm_spi_transmit_setup_dma</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*spi<sp/>tx<sp/>data<sp/>dma*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a6fa7c7a09d860dd39bfc697dc86b8805" kindref="member">dma_mgr_get_default_chn_config</ref>(&amp;chg_config);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac303c1f78599127bfd07a5521b043d96" kindref="member">src_mode</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1aa6dbf20840d2626367b1004f62ebed94" kindref="member">DMA_MGR_HANDSHAKE_MODE_NORMAL</ref>;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1abf3c7490a04d741952f14117c0c219ca" kindref="member">src_width</ref><sp/>=<sp/>data_width;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac01d4358e7b04bd3a475761e065faa33" kindref="member">src_addr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)data);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a3b847bbfd4476ca8b9b21262c038e40a" kindref="member">src_addr_ctrl</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1acd3e64e6a97e8b07eb8ce75f78519db2" kindref="member">DMA_MGR_ADDRESS_CONTROL_INCREMENT</ref>;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ab573d54934a8be3099437c5f2acb0311" kindref="member">dst_addr_ctrl</ref><sp/>=<sp/><ref refid="group__dma__interface_1gadec283cc248f55399685c1f27b2bcc08" kindref="member">DMA_ADDRESS_CONTROL_FIXED</ref>;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a54a6d295af50ab705a6ecd6371d6893f" kindref="member">dst_mode</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a20c3bf11dfdafef0b1c54d1f1da18676" kindref="member">DMA_MGR_HANDSHAKE_MODE_HANDSHAKE</ref>;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac279789f91bdd9945aad4e7d31495303" kindref="member">dst_addr</ref><sp/>=<sp/>(uint32_t)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>-&gt;<ref refid="structSPI__Type_1a63fce340a6d0378668d55df1e5c2dc99" kindref="member">DATA</ref>;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a055cf9ef45e9b7868f53821997a40297" kindref="member">dst_width</ref><sp/>=<sp/>data_width;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a02caa298cdd484fca1177cf515c3f1fb" kindref="member">en_dmamux</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a1f3e6087105526e53e49f1323a987e34" kindref="member">dmamux_src</ref><sp/>=<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1acb17e7eedcb0bd90de32fa0731624f16" kindref="member">txdma_src</ref>;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a3e26dd2c69e6087d35b1d117da10fe42" kindref="member">priority</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1acbbc9802cb005ba71f465efb031e871e" kindref="member">DMA_MGR_CHANNEL_PRIORITY_HIGH</ref>;</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a868bb43bbed23e7b959793a41a2295c4" kindref="member">size_in_byte</ref><sp/>=<sp/>(<ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref><sp/>&lt;&lt;<sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1abf3c7490a04d741952f14117c0c219ca" kindref="member">src_width</ref>)<sp/>&gt;&gt;<sp/>data_width;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a978e7e2f4e8e9b342de6a43d6975ff5b" kindref="member">dma_mgr_setup_channel</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a97ad488075d47df744a1ba65bce30b29" kindref="member">tx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>,<sp/>&amp;chg_config);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a66418c75052465b695b7fe6cc54ecf5a" kindref="member">dma_mgr_enable_channel</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a97ad488075d47df744a1ba65bce30b29" kindref="member">tx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a3308a6573d3e8733ff6236d414ebcf65" kindref="member">write_cs</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1ada8fe284a5391397106a3e2d41ddba68" kindref="member">cs_pin</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga562215822bb5267cc54accab7c737c0f" kindref="member">gptmr_enable_irq</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/><ref refid="group__gptmr__interface_1gaaf1fc6b5889cb5dbb84cd4ec1fcb3e59" kindref="member">GPTMR_CH_RLD_IRQ_MASK</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>));</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a05f225468a8d78e2032d3d4dafe53d62" kindref="member">has_done</ref>)<sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a3308a6573d3e8733ff6236d414ebcf65" kindref="member">write_cs</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1ada8fe284a5391397106a3e2d41ddba68" kindref="member">cs_pin</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="196"><highlight class="normal">}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a0e403e52592e5cb9a93c3c67173879ef" kindref="member">hpm_i2s_master_over_spi_rx_config</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/>uint8_t<sp/>protocol,<sp/>uint32_t<sp/>lrck_hz,</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>audio_depth,<sp/>uint8_t<sp/>*buffer0,<sp/>uint8_t<sp/>*buffer1,<sp/>uint32_t<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>)</highlight></codeline>
<codeline lineno="200"><highlight class="normal">{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8h_1a219e66052c4c274fcf81bcc2f77652e4" kindref="member">dma_mgr_chn_conf_t</ref><sp/>chg_config;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>data_width;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i2s<sp/>==<sp/>NULL)<sp/>||<sp/>(protocol<sp/>==<sp/><ref refid="group__i2s__common__interface_1ga86d7996f9c01e74c88f6b37ce16029f7" kindref="member">I2S_PROTOCOL_PCM</ref>)<sp/>||<sp/>(protocol<sp/>==<sp/><ref refid="group__i2s__common__interface_1gabece0f02b44d51a07def8da708429ae9" kindref="member">I2S_PROTOCOL_I2S_PHILIPS</ref>)<sp/>||</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((buffer0<sp/>==<sp/>NULL)<sp/>&amp;&amp;<sp/>(buffer1<sp/>==<sp/>NULL))<sp/>||</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL)<sp/>||<sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a05f225468a8d78e2032d3d4dafe53d62" kindref="member">has_done</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(audio_depth<sp/>==<sp/>16U)<sp/>{</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a372c1d975c39d4c6bf64ba13973900d3" kindref="member">DMA_MGR_TRANSFER_WIDTH_HALF_WORD</ref>;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__spi__interface_1gaa4cff3b8b0cb8f5bf03c36e69d5ee5bb" kindref="member">spi_set_data_bits</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/>16);</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a6c95497847a0e4fcdd06f58699100006" kindref="member">DMA_MGR_TRANSFER_WIDTH_WORD</ref>;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__spi__interface_1gaa4cff3b8b0cb8f5bf03c36e69d5ee5bb" kindref="member">spi_set_data_bits</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/>32);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref><sp/>/<sp/>(1<sp/>&lt;&lt;<sp/>data_width))<sp/>&gt;<sp/><ref refid="HPM5300_2HPM5301_2hpm__soc__feature_8h_1a9ab6af43398ba35709ba46f496487bc5" kindref="member">SPI_SOC_TRANSFER_COUNT_MAX</ref>)<sp/>{</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a034ba286743fd52314032e18105969e6" kindref="member">i2s_rx</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__spi_8c_1af51f2d625f9f8cabd4fa24da120d43a6" kindref="member">hpm_spi_receive_setup_dma</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__spi__interface_1gac397be35fa26126ce85d46ca94d13c03" kindref="member">spi_set_rx_fifo_threshold</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>,<sp/><ref refid="HPM5300_2HPM5301_2hpm__soc__feature_8h_1ad6f1ef6a80e60f0e60dc39a3366ce4cf" kindref="member">SPI_SOC_FIFO_DEPTH</ref>);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a6fa7c7a09d860dd39bfc697dc86b8805" kindref="member">dma_mgr_get_default_chn_config</ref>(&amp;chg_config);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*spi<sp/>rx<sp/>data<sp/>dma*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a3e26dd2c69e6087d35b1d117da10fe42" kindref="member">priority</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1acbbc9802cb005ba71f465efb031e871e" kindref="member">DMA_MGR_CHANNEL_PRIORITY_HIGH</ref>;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac303c1f78599127bfd07a5521b043d96" kindref="member">src_mode</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a20c3bf11dfdafef0b1c54d1f1da18676" kindref="member">DMA_MGR_HANDSHAKE_MODE_HANDSHAKE</ref>;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1abf3c7490a04d741952f14117c0c219ca" kindref="member">src_width</ref><sp/>=<sp/>data_width;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac01d4358e7b04bd3a475761e065faa33" kindref="member">src_addr</ref><sp/>=<sp/>(uint32_t)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>-&gt;<ref refid="structSPI__Type_1a63fce340a6d0378668d55df1e5c2dc99" kindref="member">DATA</ref>;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a3b847bbfd4476ca8b9b21262c038e40a" kindref="member">src_addr_ctrl</ref><sp/>=<sp/><ref refid="group__dma__interface_1gadec283cc248f55399685c1f27b2bcc08" kindref="member">DMA_ADDRESS_CONTROL_FIXED</ref>;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ab573d54934a8be3099437c5f2acb0311" kindref="member">dst_addr_ctrl</ref><sp/>=<sp/><ref refid="group__dma__interface_1gac26c5a0b3cb46ddddc026ca3123c893f" kindref="member">DMA_ADDRESS_CONTROL_INCREMENT</ref>;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a54a6d295af50ab705a6ecd6371d6893f" kindref="member">dst_mode</ref><sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1aa6dbf20840d2626367b1004f62ebed94" kindref="member">DMA_MGR_HANDSHAKE_MODE_NORMAL</ref>;</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac279789f91bdd9945aad4e7d31495303" kindref="member">dst_addr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)buffer0);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a055cf9ef45e9b7868f53821997a40297" kindref="member">dst_width</ref><sp/>=<sp/>data_width;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a02caa298cdd484fca1177cf515c3f1fb" kindref="member">en_dmamux</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a1f3e6087105526e53e49f1323a987e34" kindref="member">dmamux_src</ref><sp/>=<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a62b22d76d849048bba1db5188bb1bdf5" kindref="member">rxdma_src</ref>;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a868bb43bbed23e7b959793a41a2295c4" kindref="member">size_in_byte</ref><sp/>=<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(buffer1<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a72f3f53fb92ff3c18e7163ae2714cd90" kindref="member">linked_ptr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a22e5ccb0d335d2c971048757c5c9fc2e" kindref="member">descriptors</ref>[1]);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1aa7bf392b5f22beebdf1bb59975d67fe0" kindref="member">dma_mgr_config_linked_descriptor</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>,</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;chg_config,<sp/>(<ref refid="hpm__dma__mgr_8h_1a016fe6af7c4ddce52f16ef590b89a6b7" kindref="member">dma_mgr_linked_descriptor_t</ref><sp/>*)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a22e5ccb0d335d2c971048757c5c9fc2e" kindref="member">descriptors</ref>[0]);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac279789f91bdd9945aad4e7d31495303" kindref="member">dst_addr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)buffer1);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a72f3f53fb92ff3c18e7163ae2714cd90" kindref="member">linked_ptr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a22e5ccb0d335d2c971048757c5c9fc2e" kindref="member">descriptors</ref>[0]);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1aa7bf392b5f22beebdf1bb59975d67fe0" kindref="member">dma_mgr_config_linked_descriptor</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>,</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;chg_config,<sp/>(<ref refid="hpm__dma__mgr_8h_1a016fe6af7c4ddce52f16ef590b89a6b7" kindref="member">dma_mgr_linked_descriptor_t</ref><sp/>*)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a22e5ccb0d335d2c971048757c5c9fc2e" kindref="member">descriptors</ref>[1]);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1ac279789f91bdd9945aad4e7d31495303" kindref="member">dst_addr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)buffer0);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chg_config.<ref refid="structhpm__dma__mgr__chn__conf_1a72f3f53fb92ff3c18e7163ae2714cd90" kindref="member">linked_ptr</ref><sp/>=<sp/><ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a721e0d5de9fd2d5dd577d5e89e1abb3a" kindref="member">core_local_mem_to_sys_address</ref>(<ref refid="HPM5300_2HPM5301_2hpm__misc_8h_1a72373b15bc6fffd9ec6688b6406cc65d" kindref="member">HPM_CORE0</ref>,<sp/>(uint32_t)&amp;i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a22e5ccb0d335d2c971048757c5c9fc2e" kindref="member">descriptors</ref>[1]);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a978e7e2f4e8e9b342de6a43d6975ff5b" kindref="member">dma_mgr_setup_channel</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>,<sp/>&amp;chg_config);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__i2s__over__spi_8c_1a622b2eb58c856444711d7b94eff589b2" kindref="member">i2s_clocks_init</ref>(i2s,<sp/>lrck_hz,<sp/>audio_depth,<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="258"><highlight class="normal">}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a7e4246f1510bc5a046c728d78a064a16" kindref="member">hpm_i2s_master_over_spi_rx_start</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/><ref refid="hpm__i2s__over__spi_8h_1ab47745e0fc578dbef2e50018ca9f68f0" kindref="member">i2s_rx_data_tc</ref><sp/>callback)</highlight></codeline>
<codeline lineno="261"><highlight class="normal">{</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i2s<sp/>==<sp/>NULL)<sp/>||<sp/>(callback<sp/>==<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a034ba286743fd52314032e18105969e6" kindref="member">i2s_rx</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1acdfd03954b8602c6b460c2a078ac3136" kindref="member">rx_callback</ref><sp/>=<sp/>callback;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a66418c75052465b695b7fe6cc54ecf5a" kindref="member">dma_mgr_enable_channel</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga562215822bb5267cc54accab7c737c0f" kindref="member">gptmr_enable_irq</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/><ref refid="group__gptmr__interface_1gaaf1fc6b5889cb5dbb84cd4ec1fcb3e59" kindref="member">GPTMR_CH_RLD_IRQ_MASK</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>));</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a3308a6573d3e8733ff6236d414ebcf65" kindref="member">write_cs</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1ada8fe284a5391397106a3e2d41ddba68" kindref="member">cs_pin</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga58f680c468d7b8d3eaba476546e77162" kindref="member">gptmr_start_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="277"><highlight class="normal">}</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a9f47246ce5b13162fbcd579810cc19fa" kindref="member">hpm_i2s_master_over_spi_rx_stop</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s)</highlight></codeline>
<codeline lineno="280"><highlight class="normal">{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a034ba286743fd52314032e18105969e6" kindref="member">i2s_rx</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaf16ff57ecd3fd9a2124c50d2bb09c530" kindref="member">gptmr_stop_counter</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hpm__dma__mgr_8c_1a97aaeb542ee636d7b0d1aa8dbb0f92cd" kindref="member">dma_mgr_disable_channel</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a486643fcbc22d40acd734b41c035d41a" kindref="member">rx_dma</ref>.<ref refid="structhpm__i2s__dma__context__t_1a7b91e80c6970ad9a95e75cfb9f2019c9" kindref="member">resource</ref>);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafc4c41011fc6725c7883fd38270de74c" kindref="member">gptmr_disable_irq</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/><ref refid="group__gptmr__interface_1gaaf1fc6b5889cb5dbb84cd4ec1fcb3e59" kindref="member">GPTMR_CH_RLD_IRQ_MASK</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>));</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a3308a6573d3e8733ff6236d414ebcf65" kindref="member">write_cs</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1ada8fe284a5391397106a3e2d41ddba68" kindref="member">cs_pin</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="297"><highlight class="normal">}</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a2265491427162bd9d1f166436ec3f008" kindref="member">hpm_i2s_master_over_spi_tx_config</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/>uint8_t<sp/>protocol,<sp/>uint32_t<sp/>lrck_hz,<sp/>uint32_t<sp/>audio_depth,<sp/>uint32_t<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>)</highlight></codeline>
<codeline lineno="300"><highlight class="normal">{</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/>stat<sp/>=<sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i2s<sp/>==<sp/>NULL)<sp/>||</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(protocol<sp/>==<sp/><ref refid="group__i2s__common__interface_1ga86d7996f9c01e74c88f6b37ce16029f7" kindref="member">I2S_PROTOCOL_PCM</ref>)<sp/>||</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(protocol<sp/>==<sp/><ref refid="group__i2s__common__interface_1gabece0f02b44d51a07def8da708429ae9" kindref="member">I2S_PROTOCOL_I2S_PHILIPS</ref>))<sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(protocol<sp/>==<sp/><ref refid="group__i2s__common__interface_1ga49431c09fef3e9e853671c33720b89cf" kindref="member">I2S_PROTOCOL_LSB_JUSTIFIED</ref>)<sp/>{</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a2767793f1b816894abe3d64c8dd6efaf" kindref="member">spi_slave</ref>.<ref refid="structhpm__i2s__spi__context__t_1a99951f43fb081ccd7b96bb1b8d40bba0" kindref="member">ptr</ref>-&gt;<ref refid="structSPI__Type_1a46813b468c53af3cabea791c7b076455" kindref="member">TRANSFMT</ref><sp/>&amp;=<sp/><ref refid="HPM5300_2ip_2hpm__spi__regs_8h_1a5a92cbde0eebb2b9c5ae8989a919db27" kindref="member">~SPI_TRANSFMT_MOSIBIDIR_MASK</ref>;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>stat<sp/>=<sp/><ref refid="hpm__i2s__over__spi_8c_1a622b2eb58c856444711d7b94eff589b2" kindref="member">i2s_clocks_init</ref>(i2s,<sp/>lrck_hz,<sp/>audio_depth,<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>);</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="312"><highlight class="normal">}</highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/><ref refid="hpm__i2s__over__spi_8c_1a622b2eb58c856444711d7b94eff589b2" kindref="member">i2s_clocks_init</ref>(<ref refid="hpm__i2s__over__spi_8h_1adba1a95621064982eba9a5194955b24a" kindref="member">hpm_i2s_over_spi_t</ref><sp/>*i2s,<sp/>uint32_t<sp/>lrck_hz,<sp/>uint32_t<sp/>audio_depth,<sp/>uint32_t<sp/><ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref>)</highlight></codeline>
<codeline lineno="315"><highlight class="normal">{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1ga087efae82a4b174a0363363d9d5ece19" kindref="member">hpm_stat_t</ref><sp/>stat<sp/>=<sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa99d8737a9b635c0c9d87d7ac65801ce7" kindref="member">status_success</ref>;</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1ga321e76e4cdae6b46ce3714587192acc8" kindref="member">gptmr_channel_config_t</ref><sp/>config;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>data_width;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>actual_reload<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>actual_fclk_rld<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>actual_fclk_half_rld<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>pwm_freq_hz<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bclk_hz<sp/>=<sp/>(2<sp/>*<sp/>lrck_hz<sp/>*<sp/>audio_depth);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(audio_depth<sp/>==<sp/>16U)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a372c1d975c39d4c6bf64ba13973900d3" kindref="member">DMA_MGR_TRANSFER_WIDTH_HALF_WORD</ref>;</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_width<sp/>=<sp/><ref refid="hpm__dma__mgr_8h_1a6c95497847a0e4fcdd06f58699100006" kindref="member">DMA_MGR_TRANSFER_WIDTH_WORD</ref>;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(((<ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref><sp/>/<sp/>(1<sp/>&lt;&lt;<sp/>data_width))<sp/>&gt;<sp/><ref refid="HPM5300_2HPM5301_2hpm__soc__feature_8h_1a9ab6af43398ba35709ba46f496487bc5" kindref="member">SPI_SOC_TRANSFER_COUNT_MAX</ref>)<sp/>||</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL)<sp/>||</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL)<sp/>||</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>set<sp/>bclk<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="group__common__interface_1gga57008dafb69438605b6d0039d9ed7a8fa380c9b8304ad8399f1be634d6f5c4701" kindref="member">status_invalid_argument</ref>;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__clock__interface_1ga044a6e24b793b3a081cf9804d0a66f8e" kindref="member">clock_add_to_group</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1a533bd029b2e4c014b3a7a6d491e901f2" kindref="member">clock_name</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaa0f6ed9cdd9b7a88b8f1db2825e8bf02" kindref="member">gptmr_channel_get_default_config</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>&amp;config);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/>pwm_freq_hz<sp/>=<sp/><ref refid="group__clock__interface_1ga0b6cfe27aaccef750309ac03a4285189" kindref="member">clock_get_frequency</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1a533bd029b2e4c014b3a7a6d491e901f2" kindref="member">clock_name</ref>);</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/>actual_reload<sp/>=<sp/>pwm_freq_hz<sp/>/<sp/>bclk_hz;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1abcff8c07885d004c2b0feabb43c26873" kindref="member">cmp</ref>[0]<sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1ac50f7a8f07d5e9f214ac8fb4a71b0b36" kindref="member">reload</ref><sp/>=<sp/>actual_reload;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1abcff8c07885d004c2b0feabb43c26873" kindref="member">cmp</ref>[1]<sp/>=<sp/>(actual_reload<sp/>/<sp/>2);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1a93b4aa0e83f110d2ffd306042bbb5784" kindref="member">cmp_initial_polarity_high</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1a2f1490ec6091d59206cee639860b119c" kindref="member">enable_software_sync</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1ab9f0788db17d11cf4a6567f184a668c3" kindref="member">enable_cmp_output</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1gae5a4c4e106257107efe0a26851a72491" kindref="member">HPM_CHECK_RET</ref>(<ref refid="group__gptmr__interface_1gae16d0ba6475ab599328953195f87a1dd" kindref="member">gptmr_channel_config</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>,<sp/>&amp;config,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1aafca242afe81bdd406f54acde8cdb137" kindref="member">bclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>set<sp/>lrck<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__clock__interface_1ga044a6e24b793b3a081cf9804d0a66f8e" kindref="member">clock_add_to_group</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1a533bd029b2e4c014b3a7a6d491e901f2" kindref="member">clock_name</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>actual_reload<sp/>*=<sp/>(audio_depth<sp/>*<sp/>2);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>actual_fclk_rld<sp/>=<sp/>actual_reload;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1ab9f0788db17d11cf4a6567f184a668c3" kindref="member">enable_cmp_output</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1ac50f7a8f07d5e9f214ac8fb4a71b0b36" kindref="member">reload</ref><sp/>=<sp/>actual_reload;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1abcff8c07885d004c2b0feabb43c26873" kindref="member">cmp</ref>[0]<sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1abcff8c07885d004c2b0feabb43c26873" kindref="member">cmp</ref>[1]<sp/>=<sp/>(actual_reload<sp/>/<sp/>2);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1gae5a4c4e106257107efe0a26851a72491" kindref="member">HPM_CHECK_RET</ref>(<ref refid="group__gptmr__interface_1gae16d0ba6475ab599328953195f87a1dd" kindref="member">gptmr_channel_config</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>,<sp/>&amp;config,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae4192f5f125a9b69810d4ea7a4971dfd" kindref="member">lrck</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>set<sp/>transfer<sp/>is<sp/>completed<sp/>time<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__clock__interface_1ga044a6e24b793b3a081cf9804d0a66f8e" kindref="member">clock_add_to_group</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1a533bd029b2e4c014b3a7a6d491e901f2" kindref="member">clock_name</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaa0f6ed9cdd9b7a88b8f1db2825e8bf02" kindref="member">gptmr_channel_get_default_config</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>&amp;config);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>left<sp/>and<sp/>right<sp/>so<sp/>/2*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>actual_fclk_half_rld<sp/>=<sp/>(actual_reload<sp/>/<sp/>2);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/>actual_reload<sp/>=<sp/>actual_fclk_half_rld<sp/>*<sp/>(<ref refid="group__nnactivation_1gaf8fd9ce16b371c8a3bf5e0b37a69419f" kindref="member">size</ref><sp/>/<sp/>(audio_depth<sp/>/<sp/>8));</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>wait<sp/>20<sp/>half_fclk<sp/>tick<sp/>for<sp/>rx<sp/>finish<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/>actual_reload<sp/>+=<sp/>(actual_fclk_half_rld<sp/>*<sp/>20);</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1ac50f7a8f07d5e9f214ac8fb4a71b0b36" kindref="member">reload</ref><sp/>=<sp/>actual_reload;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__common__interface_1gae5a4c4e106257107efe0a26851a72491" kindref="member">HPM_CHECK_RET</ref>(<ref refid="group__gptmr__interface_1gae16d0ba6475ab599328953195f87a1dd" kindref="member">gptmr_channel_config</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>,<sp/>&amp;config,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1ae378308e439dd49e5d0658fca55cf358" kindref="member">transfer_time</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>set<sp/>mclk*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__clock__interface_1ga044a6e24b793b3a081cf9804d0a66f8e" kindref="member">clock_add_to_group</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1a533bd029b2e4c014b3a7a6d491e901f2" kindref="member">clock_name</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gaa0f6ed9cdd9b7a88b8f1db2825e8bf02" kindref="member">gptmr_channel_get_default_config</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>&amp;config);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>actual_reload<sp/>=<sp/>actual_fclk_rld<sp/>/<sp/>256;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1ac50f7a8f07d5e9f214ac8fb4a71b0b36" kindref="member">reload</ref><sp/>=<sp/>actual_reload;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1abcff8c07885d004c2b0feabb43c26873" kindref="member">cmp</ref>[0]<sp/>=<sp/>actual_reload<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1abcff8c07885d004c2b0feabb43c26873" kindref="member">cmp</ref>[1]<sp/>=<sp/>actual_reload;</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>config.<ref refid="structgptmr__channel__config_1ab9f0788db17d11cf4a6567f184a668c3" kindref="member">enable_cmp_output</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gae16d0ba6475ab599328953195f87a1dd" kindref="member">gptmr_channel_config</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>,<sp/>&amp;config,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__gptmr__interface_1gafb8defc3dad0162acdea039259515de9" kindref="member">gptmr_channel_reset_count</ref>(i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab97c3c1134c0032e03c7bdbd1294f61b" kindref="member">ptr</ref>,<sp/>i2s-&gt;<ref refid="structhpm__i2s__over__spi_1a885a9ed778ee77db3ccfbe1116c32743" kindref="member">mclk</ref>.<ref refid="structhpm__i2s__gptmr__context__t_1ab4f7d8e5553f2b70a2c241dbb2244e8d" kindref="member">channel</ref>);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="388"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="components/i2s_over_spi/hpm_i2s_over_spi.c"/>
  </compounddef>
</doxygen>
