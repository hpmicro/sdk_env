<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>21.1. Multicore General Description &mdash; HPMicro Software Development Kit  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/tabs.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="21.2. Console Coremark Demo" href="console_coremark/README_en.html" />
    <link rel="prev" title="21. Multicore" href="index_en.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index_en.html">Evaluation Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/index_en.html">Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index_en.html">Samples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../audio_codec/index_en.html">1. Audio Codec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../canopen/README_en.html">2. CANOPEN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cherryrb/README_en.html">3. CherryRB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cherryusb/index_en.html">4. CherryUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coremark/README_en.html">5. CoreMark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dhrystone/README_en.html">6. Dhrystone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dma_manager/README_en.html">7. DMA Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dsp/README_en.html">8. DSP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eeprom_emulation/index_en.html">9. EEPROM Emulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../freemaster/README_en.html">10. Freemaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hello_world/README_en.html">11. Hello World</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpm_math/index_en.html">12. HPM Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/index_en.html">13. IMAGE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lvgl/index_en.html">14. LVGL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lwip/index_en.html">15. lwIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls/README_en.html">16. Mbedtls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memstress/index_en.html">17. Memory Stress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microros/index_en.html">18. Microros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modbus/index_en.html">19. Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../motor_ctrl/index_en.html">20. HPM Motor Ctrl</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index_en.html">21. Multicore</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">21.1. Multicore General Description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">21.1.1. Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#memory-allocation">21.1.2. Memory Allocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core1-code-storage-location">21.1.3. Core1 Code Storage Location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-project">21.1.4. Generate project</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compile-project">21.1.5. Compile project</a></li>
<li class="toctree-l4"><a class="reference internal" href="#debugging-the-example">21.1.6. Debugging the Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#download-to-flash-and-run">21.1.7. Download to Flash and Run</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="console_coremark/README_en.html">21.2. Console Coremark Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="erpc/erpc_matrix_multiply_rpmsg_bm/README_en.html">21.3. eRPC bare metal demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="erpc/erpc_matrix_multiply_rpmsg_rtos/README_en.html">21.4. eRPC rtos demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="erpc/erpc_motor/README_en.html">21.5. OpENer Erpc Motor</a></li>
<li class="toctree-l3"><a class="reference internal" href="erpc/erpc_two_way_rpc_rpmsg_rtos/README_en.html">21.6. eRPC two_way_rpc demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="hello/README_en.html">21.7. Hello demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="lvgl_coremark/README_en.html">21.8. LVGL Coremark Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="mbx/README_en.html">21.9. MBX dualcore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../power_mode_switch/README_en.html">22. Power Mode Switch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rgb_led/README_en.html">23. RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rom_api/index_en.html">24. ROM API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rtos/index_en.html">25. RTOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rvbacktrace/index_en.html">26. Rvbacktrace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segger_rtt/README_en.html">27. Segger RTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tflm/index_en.html">28. TensorFlowLiteMicro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tinycrypt/index_en.html">29. Tinycrypt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tinyengine/person_obj/README_en.html">30. Person Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tinyuf2/README_en.html">31. TinyUF2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tinyusb/index_en.html">32. TinyUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../touch_panel/README_en.html">33. Touch Panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vglite/index_en.html">34. VGLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spi_components/index_en.html">35. SPI_COMPONENTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i2s_emulation/README_en.html">36. I2S EMULATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spi_sdcard/index_en.html">37. SPI_SDCARD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cherrysh/index_en.html">38. CherrySH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ethercat/index_en.html">39. EtherCAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../smbus/index_en.html">40. SMbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pmbus/index_en.html">41. PMbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tsn/index_en.html">42. tsn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../opener/index_en.html">43. OpENer Ethernet/IP Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trace_recorder/index_en.html">44. Trace Recorder</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../drivers/index_en.html">Drivers Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/cmake_intro.html">SDK CMake API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc.html">SDK API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HPMicro Software Development Kit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index_en.html">Samples</a></li>
          <li class="breadcrumb-item"><a href="index_en.html"><span class="section-number">21. </span>Multicore</a></li>
      <li class="breadcrumb-item active"><span class="section-number">21.1. </span>Multicore General Description</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/samples/multicore/README_en.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="multicore-general-description">
<h1><span class="section-number">21.1. </span>Multicore General Description<a class="headerlink" href="#multicore-general-description" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2><span class="section-number">21.1.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>Core0 and Core1 are two independent cores, each with its own internal independent resources, such as ILM/DLM, PLIC, MCHTMR, FGPIO, PMP/PMA, etc. Both also have peripheral resources shared by SOC, such as AXI_ SRAM, UART, DMA, etc. In dual core design, it is necessary to plan the allocation of memory resources and peripheral resources.</p>
<p>The system always starts from Core0, and Core1 cannot self start, so Core0 is the primary core and Core1 is the secondary core. After Core0 starts, it initializes the basic resources of SOC, such as clock, memory, power, etc. Then, it specifies the start address of Core1 and releases Core1, so that the dual core can run.</p>
</section>
<section id="memory-allocation">
<h2><span class="section-number">21.1.2. </span>Memory Allocation<a class="headerlink" href="#memory-allocation" title="Permalink to this heading"></a></h2>
<p>The organization diagram of the dual core sample memory is as follows:</p>
<p><img alt="Multicore_Memory.png" src="../../_images/Multicore_Memory.png" /></p>
<ul class="simple">
<li><p>Core0: It has ILM, DLM, XIP Flash, SRAM/SDRAM, NonCachable memory, and shared memory with Core1. The code can run in ILM or XIP Flash, and the data is in DLM or SRAM/SDRAM.</p></li>
<li><p>Core1: It has ILM, DLM, SRAM/SDRAM, NonCachable memory, and shared memory with Core0. The code runs in ILM, and the data is in DLM or SRAM/SDRAM.</p></li>
</ul>
</section>
<section id="core1-code-storage-location">
<h2><span class="section-number">21.1.3. </span>Core1 Code Storage Location<a class="headerlink" href="#core1-code-storage-location" title="Permalink to this heading"></a></h2>
<p>The linker file of Core1 Project is not linked to Flash, so how is its code stored?</p>
<p>The answer is our current organizational approach is that after Core1 is compiled, the binary file of Core1 will be automatically generated <strong>sec_core_img.c</strong> by the <strong>bin2c.py</strong> script, then automatically copied to the Project of Core0. So when compiling Core0, the content of Core1 image will be compiled into the <strong>.rodata</strong> section of Core0, as shown in the organization diagram of the memory mentioned above.</p>
<p>When Core0 starts, it will copy the <strong>sec_core_img.c</strong> content of Core1 image into the ILM of Core1, and then specify the start address of Core1 as ILM and release Core1, so that Core1 runs.</p>
</section>
<section id="generate-project">
<h2><span class="section-number">21.1.4. </span>Generate project<a class="headerlink" href="#generate-project" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>When users use Cmake to generate a Core0 project, it will automatically be associated to generate a Core1 project.</p></li>
<li><p>After generating the Core1 Project, it will be automatically compiled by the RISC-V GCC toolchain. This requires special attention!</p></li>
<li><p>After the Core1 Project is compiled, the bin file will be automatically generated <strong>sec_core_img.c</strong> file by the <strong>bin2c.py</strong> script and automatically copy it to Core0 project.</p></li>
<li><p>At this time, both Core0 and Core1 projects have been generated, and the Core1 project has been compiled by the RISC-V GCC toolchain.</p></li>
<li><p>ATTENTION:</p>
<ul>
<li><p>If the associated Core1 Project fails to generate or compile, then the Core0 Project cannot be generated either. Now, users can generate or compile the Core1 Project separately to troubleshoot issues. After the problem is resolved, regenerate the Core0 Project.</p></li>
</ul>
</li>
</ul>
</section>
<section id="compile-project">
<h2><span class="section-number">21.1.5. </span>Compile project<a class="headerlink" href="#compile-project" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Complie Core1 Project first</p>
<ul>
<li><p>Due to the Core1 Project is automatically compiled by the RISC-V GCC toolchain, if users need to use the Segger Embedded Studio toolchain, they can open the Core1 Project by Segger Embedded Studio and execute the compilation.</p></li>
</ul>
</li>
<li><p>Then, Complie Core0 Project</p>
<ul>
<li><p>If users need to use the Segger Embedded Studio toolchain, they can open the Core0 Project by Segger Embedded Studio and execute the compilation.</p></li>
</ul>
</li>
<li><p>ATTENTION:</p>
<ul>
<li><p>When the files of the Core1 Project are updated, recompiling the Core1 Project will automatically update the <strong>sec_core_img.c</strong> file under the Core0 Project. Therefore, it is necessary to recompile the Core0 Project to update the content of the Core1 Image.</p></li>
</ul>
</li>
</ul>
</section>
<section id="debugging-the-example">
<h2><span class="section-number">21.1.6. </span>Debugging the Example<a class="headerlink" href="#debugging-the-example" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Opening the projects for Core0 and Core1 respectively.</p></li>
<li><p>Compile the core1 example first, then compile the core0 example.</p></li>
<li><p>Download the core0 example to the target and run core0 example first.</p></li>
<li><p>Download the core1 example to the target and run core1 example.</p></li>
<li><p>ATTENTION:</p>
<ul>
<li><p>When debugging, users must run Core0 first and then Core1. Because Core0 will initialize the clock, power supply, etc. first.</p></li>
</ul>
</li>
</ul>
</section>
<section id="download-to-flash-and-run">
<h2><span class="section-number">21.1.7. </span>Download to Flash and Run<a class="headerlink" href="#download-to-flash-and-run" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>When users no need to debug, only need to download the core0 example to the target Flash, then stop debugging and reset the board. Because the <em><strong>elf</strong></em> file generated by <strong>Core0</strong> contains the content generated by <strong>Core1</strong>.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2024, HPMicro.
      <span class="lastupdated">Last updated on Dec 30, 2024.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>