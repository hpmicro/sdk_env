<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>26.6. eRPC two_way_rpc demo &mdash; HPMicro Software Development Kit  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="26.7. Hello demo" href="../../hello/README_en.html" />
    <link rel="prev" title="26.5. OpENer Erpc Motor" href="../erpc_motor/README_en.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="../../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../boards/index_en.html">Evaluation Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components/index_en.html">Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index_en.html">Samples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../audio_codec/index_en.html">1. Audio Codec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../canopen/README_en.html">2. CANOPEN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cherryrb/README_en.html">3. CherryRB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cherrysh/index_en.html">4. CherrySH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cherryusb/index_en.html">5. CherryUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../coremark/README_en.html">6. CoreMark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dhrystone/README_en.html">7. Dhrystone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dma_manager/README_en.html">8. DMA Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dsp/README_en.html">9. DSP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dual_panel/README_en.html">10. DUAL_PANEL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../eeprom_emulation/index_en.html">11. EEPROM Emulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ethercat/index_en.html">12. EtherCAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../freemaster/README_en.html">13. Freemaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hello_world/README_en.html">14. Hello World</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hpm_math/index_en.html">15. HPM Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../i2c_components/index_en.html">16. I2C Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../i2s_emulation/README_en.html">17. I2S EMULATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../image/index_en.html">18. Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lvgl/index_en.html">19. LVGL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lwip/index_en.html">20. lwIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mbedtls/README_en.html">21. Mbedtls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../memstress/index_en.html">22. Memory Stress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../microros/index_en.html">23. Microros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modbus/index_en.html">24. Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../motor_ctrl/index_en.html">25. HPM Motor Ctrl</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index_en.html">26. Multicore</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../README_en.html">26.1. Multicore General Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../console_coremark/README_en.html">26.2. Console Coremark Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../erpc_matrix_multiply_rpmsg_bm/README_en.html">26.3. eRPC bare metal demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../erpc_matrix_multiply_rpmsg_rtos/README_en.html">26.4. eRPC rtos demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../erpc_motor/README_en.html">26.5. OpENer Erpc Motor</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">26.6. eRPC two_way_rpc demo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">26.6.1. Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#idl-file-generate-project-files">26.6.2. IDL file generate project files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#importing-client-server-files">26.6.3. Importing client/server files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-build-and-debug-multi-core-projects">26.6.4. Generate, Build and Debug Multi-core projects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-results">26.6.5. Running Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../hello/README_en.html">26.7. Hello demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lvgl_coremark/README_en.html">26.8. LVGL Coremark Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mbx/README_en.html">26.9. MBX dualcore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../opener/index_en.html">27. OpENer Ethernet/IP Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pmbus/index_en.html">28. PMbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../power_mode_switch/README_en.html">29. Power Mode Switch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rgb_led/README_en.html">30. RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rom_api/index_en.html">31. ROM API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rtos/index_en.html">32. RTOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rvbacktrace/index_en.html">33. Rvbacktrace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../segger_rtt/README_en.html">34. Segger RTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../segment_led_key/README_en.html">35. SEGMENT LED KEY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../smbus/index_en.html">36. SMbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../spi_components/index_en.html">37. SPI Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../spi_sdcard/index_en.html">38. SPI SD Card</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tflm/index_en.html">39. TensorFlow Lite For Microcontroller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tinycrypt/index_en.html">40. Tinycrypt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tinyengine/person_obj/README_en.html">41. Person Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tinyuf2/README_en.html">42. TinyUF2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tinyusb/index_en.html">43. TinyUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../touch_panel/README_en.html">44. Touch Panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trace_recorder/index_en.html">45. Trace Recorder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tsn/index_en.html">46. tsn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vglite/index_en.html">47. VGLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sent/index_en.html">48. sent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../drivers/index_en.html">Drivers Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/cmake_intro.html">SDK CMake API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api_doc.html">SDK API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../CHANGELOG.html">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">HPMicro Software Development Kit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index_en.html">Samples</a></li>
          <li class="breadcrumb-item"><a href="../../index_en.html"><span class="section-number">26. </span>Multicore</a></li>
      <li class="breadcrumb-item active"><span class="section-number">26.6. </span>eRPC two_way_rpc demo</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/samples/multicore/erpc/erpc_two_way_rpc_rpmsg_rtos/README_en.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="erpc-two-way-rpc-demo">
<span id="id1"></span><h1><span class="section-number">26.6. </span>eRPC two_way_rpc demo<a class="headerlink" href="#erpc-two-way-rpc-demo" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2><span class="section-number">26.6.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>This project executes two way eRPC example, uses RPMSG as transport layer protocol, uses MBX as message notification.</p>
<p>Core0 is both the client side and the server side, and similarly, core1 is also both the client side and the server side. Core0 can call the erpc function in Core1, and Core1 can also call the erp function on Core0.</p>
<p>Please refer to <a class="reference external" href="https://github.com/EmbeddedRPC/erpc">[official eRPC github]</a> and <a class="reference external" href="https://github.com/NXPmicro/rpmsg-lite">[official rpmsg_lite github]</a></p>
<p>Currently, it is developed based on erpc v1.10.0 and rpmsg-lite v5.0.0.</p>
</section>
<section id="idl-file-generate-project-files">
<h2><span class="section-number">26.6.2. </span>IDL file generate project files<a class="headerlink" href="#idl-file-generate-project-files" title="Permalink to this heading"></a></h2>
<p>IDL files contains all declarations used in eRPC calls. This demo IDL file is <strong>erpc_two_way_rpc.erpc</strong> .</p>
<p>When function is declared in erpc file as callback type function, so the definition will exists on both sides (user and erpc implementation). This way you can call function from client side and server side (as local function or erpc call).</p>
<p>Please refer to <cite>middleware/erpc/erpc/docs/IDL-Reference.md</cite></p>
<p>The easiest way for generating code is have both the tool and the IDL file in same directory (generated). Then, the following command needs be executed:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>../../../../../middleware/erpc/erpc/tools/erpcgen/Windows/erpcgen.exe erpc_two_way_rpc.erpc
</pre></div>
</div>
<dl class="simple">
<dt>This action creates eight files in current folder:</dt><dd><ul class="simple">
<li><p>erpc_two_way_rpc_Core0Interface.h</p></li>
<li><p>erpc_two_way_rpc_Core0Interface_client.cpp</p></li>
<li><p>erpc_two_way_rpc_Core0Interface_server.cpp</p></li>
<li><p>erpc_two_way_rpc_Core0Interface_server.h</p></li>
<li><p>erpc_two_way_rpc_Core1Interface.h</p></li>
<li><p>erpc_two_way_rpc_Core1Interface_client.cpp</p></li>
<li><p>erpc_two_way_rpc_Core1Interface_server.cpp</p></li>
<li><p>erpc_two_way_rpc_Core1Interface_server.h</p></li>
</ul>
</dd>
</dl>
</section>
<section id="importing-client-server-files">
<h2><span class="section-number">26.6.3. </span>Importing client/server files<a class="headerlink" href="#importing-client-server-files" title="Permalink to this heading"></a></h2>
<p><cite>Core0 project</cite> needs to import  <strong>erpc_two_way_rpc_Core0Interface_client.cpp</strong> and <strong>erpc_two_way_rpc_Core1Interface_server.cpp</strong> files. The <strong>erpc_two_way_rpc_Core0Interface.h</strong> and <strong>erpc_two_way_rpc_Core1Interface_server.h</strong> header file needs to be included.</p>
<p><cite>Core1 project</cite> needs to import  <strong>erpc_two_way_rpc_Core1Interface_client.cpp</strong> and <strong>erpc_two_way_rpc_Core0Interface_server.cpp</strong> files. The <strong>erpc_two_way_rpc_Core1Interface.h</strong> and <strong>erpc_two_way_rpc_Core0Interface_server.h</strong> header file needs to be included.</p>
</section>
<section id="generate-build-and-debug-multi-core-projects">
<h2><span class="section-number">26.6.4. </span>Generate, Build and Debug Multi-core projects<a class="headerlink" href="#generate-build-and-debug-multi-core-projects" title="Permalink to this heading"></a></h2>
<p>Please reference <a class="reference internal" href="../../README_en.html#multicore-general-description"><span class="std std-ref">Multicore General Description</span></a></p>
</section>
<section id="running-results">
<h2><span class="section-number">26.6.5. </span>Running Results<a class="headerlink" href="#running-results" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Taking HPM6750EVKMINI as an example, when the project runs successfully, The serial port terminal will output the following information:</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Primary core started</span>

<span class="go">Copying secondary core image to destination memory: 0x1180000</span>
<span class="go">Starting secondary core...</span>

<span class="go">Secondary core started...</span>
<span class="go">Get number from core1:</span>
<span class="go">Got number: 1</span>
<span class="go">Start normal rpc call example.</span>
<span class="go">RPC call example finished.</span>


<span class="go">Get number from core0:</span>
<span class="go">getNumberFromCore0 function call: Actual number is 2</span>
<span class="go">Got number: 2</span>
<span class="go">Start nested rpc call example.</span>
<span class="go">getNumberFromCore0 function call: Actual number is 2</span>
<span class="go">RPC call example finished.</span>


<span class="go">Get number from core1:</span>
<span class="go">Got number: 3</span>
<span class="go">Start normal rpc call example.</span>
<span class="go">RPC call example finished.</span>


<span class="go">Get number from core0:</span>
<span class="go">getNumberFromCore0 function call: Actual number is 5</span>
<span class="go">Got number: 5</span>
<span class="go">Start nested rpc call example.</span>
<span class="go">getNumberFromCore0 function call: Actual number is 5</span>
<span class="go">RPC call example finished.</span>


<span class="go">Get number from core1:</span>
<span class="go">Got number: 6</span>
<span class="go">Start normal rpc call example.</span>
<span class="go">RPC call example finished.</span>


<span class="go">Get number from core0:</span>
<span class="go">getNumberFromCore0 function call: Actual number is 8</span>
<span class="go">Got number: 8</span>
<span class="go">Start nested rpc call example.</span>
<span class="go">getNumberFromCore0 function call: Actual number is 8</span>
<span class="go">RPC call example finished.</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2025, HPMicro.
      <span class="lastupdated">Last updated on Mar 31, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>