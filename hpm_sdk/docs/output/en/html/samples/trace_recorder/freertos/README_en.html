<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>45.1. Trace Recorder FreeRTOS &mdash; HPMicro Software Development Kit  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="45.2. Trace Recorder RT-Thread" href="../rtthread-nano/README_en.html" />
    <link rel="prev" title="45. Trace Recorder" href="../index_en.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../boards/index_en.html">Evaluation Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../components/index_en.html">Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index_en.html">Samples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../audio_codec/index_en.html">1. Audio Codec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../canopen/README_en.html">2. CANOPEN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cherryrb/README_en.html">3. CherryRB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cherrysh/index_en.html">4. CherrySH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cherryusb/index_en.html">5. CherryUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coremark/README_en.html">6. CoreMark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dhrystone/README_en.html">7. Dhrystone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dma_manager/README_en.html">8. DMA Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dsp/README_en.html">9. DSP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dual_panel/README_en.html">10. DUAL_PANEL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../eeprom_emulation/index_en.html">11. EEPROM Emulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ethercat/index_en.html">12. EtherCAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../freemaster/README_en.html">13. Freemaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hello_world/README_en.html">14. Hello World</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hpm_math/index_en.html">15. HPM Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../i2c_components/index_en.html">16. I2C Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../i2s_emulation/README_en.html">17. I2S EMULATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../image/index_en.html">18. Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lvgl/index_en.html">19. LVGL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lwip/index_en.html">20. lwIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mbedtls/README_en.html">21. Mbedtls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../memstress/index_en.html">22. Memory Stress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../microros/index_en.html">23. Microros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modbus/index_en.html">24. Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../motor_ctrl/index_en.html">25. HPM Motor Ctrl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multicore/index_en.html">26. Multicore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../opener/index_en.html">27. OpENer Ethernet/IP Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pmbus/index_en.html">28. PMbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../power_mode_switch/README_en.html">29. Power Mode Switch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rgb_led/README_en.html">30. RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rom_api/index_en.html">31. ROM API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rtos/index_en.html">32. RTOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rvbacktrace/index_en.html">33. Rvbacktrace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../segger_rtt/README_en.html">34. Segger RTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../segment_led_key/README_en.html">35. SEGMENT LED KEY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../smbus/index_en.html">36. SMbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spi_components/index_en.html">37. SPI Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spi_sdcard/index_en.html">38. SPI SD Card</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tflm/index_en.html">39. TensorFlow Lite For Microcontroller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tinycrypt/index_en.html">40. Tinycrypt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tinyengine/person_obj/README_en.html">41. Person Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tinyuf2/README_en.html">42. TinyUF2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tinyusb/index_en.html">43. TinyUSB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../touch_panel/README_en.html">44. Touch Panel</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index_en.html">45. Trace Recorder</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">45.1. Trace Recorder FreeRTOS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">45.1.1. Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hardware-setup">45.1.2. Hardware Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operation-steps">45.1.3. Operation Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-example">45.1.4. Running the example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../rtthread-nano/README_en.html">45.2. Trace Recorder RT-Thread</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tsn/index_en.html">46. tsn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vglite/index_en.html">47. VGLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sent/index_en.html">48. sent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers/index_en.html">Drivers Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/cmake_intro.html">SDK CMake API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_doc.html">SDK API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CHANGELOG.html">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">HPMicro Software Development Kit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index_en.html">Samples</a></li>
          <li class="breadcrumb-item"><a href="../index_en.html"><span class="section-number">45. </span>Trace Recorder</a></li>
      <li class="breadcrumb-item active"><span class="section-number">45.1. </span>Trace Recorder FreeRTOS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/samples/trace_recorder/freertos/README_en.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="trace-recorder-freertos">
<span id="id1"></span><h1><span class="section-number">45.1. </span>Trace Recorder FreeRTOS<a class="headerlink" href="#trace-recorder-freertos" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2><span class="section-number">45.1.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>This project demonstrates the task scheduling function of Trace Recorder for tracking FreeRTOS.</p>
</section>
<section id="hardware-setup">
<h2><span class="section-number">45.1.2. </span>Hardware Setup<a class="headerlink" href="#hardware-setup" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>It is recommended to use JLink for tracking.</p></li>
<li><p>GDB only supports snapshot mode.</p></li>
</ul>
</section>
<section id="operation-steps">
<h2><span class="section-number">45.1.3. </span>Operation Steps<a class="headerlink" href="#operation-steps" title="Permalink to this heading"></a></h2>
<section id="snapshot-mode">
<h3><span class="section-number">45.1.3.1. </span>Snapshot mode<a class="headerlink" href="#snapshot-mode" title="Permalink to this heading"></a></h3>
<p>Add “set(CONFIG_TRACE_RECORDER_SNAPSHOT_MODE 1)” and remove “set(CONFIG_TRACE_RECORDER_STREAM_MODE “JLink RTT”)” in CMakeLists.txt to enable snapshot mode. Some hpm_build_type is not supported because there maybe not enough memory to save trace data, such as flash_xip and ram.
In snapshot mode, TraceRecorder stores data in memory. The data needs to be exported and then analyzed using a host computer tool.</p>
<section id="obtain-the-address-where-data-is-stored">
<h4><span class="section-number">45.1.3.1.1. </span>Obtain the address where data is stored<a class="headerlink" href="#obtain-the-address-where-data-is-stored" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>Open the generated.map file after compilation, search for RecorderData, and you can see its address and size.</p></li>
</ul>
</section>
<section id="export-snapshot-data">
<h4><span class="section-number">45.1.3.1.2. </span>Export snapshot data<a class="headerlink" href="#export-snapshot-data" title="Permalink to this heading"></a></h4>
<section id="using-gdb">
<h5><span class="section-number">45.1.3.1.2.1. </span>Using GDB<a class="headerlink" href="#using-gdb" title="Permalink to this heading"></a></h5>
<p>To obtain snapshot data using GDB Server, you need to connect to GDB Server first, and then run the program to prevent GDB Server from resetting MCU and losing snapshot data when connecting. Open GDB Server (openocd/JLink GDB Sever), use GDB to connect to the target, run the program, and pause the program execution when you need to export data.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tar remo :2331
mo reset halt
//Download program to target if needed
continue
//Press CTRL - C to halt mcu
dump binary memory target_data.bin {start address of RecorderData} {end address of RecorderData}
</pre></div>
</div>
<p>Then open the Tracealyzer4 software and open the target_data.bin file.</p>
</section>
<section id="using-jlink">
<h5><span class="section-number">45.1.3.1.2.2. </span>Using JLink<a class="headerlink" href="#using-jlink" title="Permalink to this heading"></a></h5>
<p>Open the Tracealyzer4 software, open snapshot mode, switch to the JLink interface, and select the target chip in the JLink configuration. In the JLink configuration, select the target chip.</p>
<img alt="" src="../../../_images/jlink_setting.jpg" />
<p>In the memory configuration, configure the starting address and size of RecorderData.</p>
<img alt="" src="../../../_images/memory_setting.jpg" />
<p>Pause the execution of the target program and then read the data.</p>
<img alt="" src="../../../_images/read_data.jpg" />
</section>
</section>
</section>
<section id="stream-mode">
<h3><span class="section-number">45.1.3.2. </span>Stream mode<a class="headerlink" href="#stream-mode" title="Permalink to this heading"></a></h3>
<p>Add “set(CONFIG_TRACE_RECORDER_STREAM_MODE “JLink RTT”)” and remove “set(CONFIG_TRACE_RECORDER_SNAPSHOT_MODE 1)” to CMakeLists.txt to enable stream mode.</p>
<section id="obtain-the-address-of-the-jlink-rtt-control-block">
<h4><span class="section-number">45.1.3.2.1. </span>Obtain the address of the JLink RTT control block<a class="headerlink" href="#obtain-the-address-of-the-jlink-rtt-control-block" title="Permalink to this heading"></a></h4>
<p>Open the generated.map file after compilation, search for the _SEGGER_RTT variable, and you can obtain its address.</p>
</section>
<section id="host-computer-software-configuration">
<h4><span class="section-number">45.1.3.2.2. </span>Host computer software configuration<a class="headerlink" href="#host-computer-software-configuration" title="Permalink to this heading"></a></h4>
<p>First, open the Tracealyzer4 software, open stream mode, switch to the JLink interface, and select the target chip in the JLink configuration. Configure the RTT control block address and the RTT channel sequence number (default is 1).</p>
<img alt="" src="../../../_images/jlink_setting_stream.jpg" />
<p>In the control interface, start data capture. Click buttons “Reset, Reconnect, Start Session” in order.</p>
<img alt="" src="../../../_images/stream.jpg" />
</section>
</section>
</section>
<section id="running-the-example">
<h2><span class="section-number">45.1.4. </span>Running the example<a class="headerlink" href="#running-the-example" title="Permalink to this heading"></a></h2>
<section id="id2">
<h3><span class="section-number">45.1.4.1. </span>Snapshot mode<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<img alt="" src="../../../_images/result.jpg" />
</section>
<section id="id3">
<h3><span class="section-number">45.1.4.2. </span>Stream mode<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p>Data can be viewed dynamically without halting the cpu.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2025, HPMicro.
      <span class="lastupdated">Last updated on Mar 31, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>