# Copyright (c) 2022-2023,2025 HPMicro
# SPDX-License-Identifier: BSD-3-Clause

cmake_minimum_required(VERSION 3.13)

set(CONFIG_HPM_PANEL 1)
set(CONFIG_LVGL 1)
if(NOT DEFINED CONFIG_TOUCH)
set(CONFIG_TOUCH "gt9xx")
endif()
set(CONFIG_HPM_TOUCH 1)

if(NOT DEFINED CONFIG_CODEC)
# set(CONFIG_CODEC "sgtl5000")
# set(CONFIG_CODEC "wm8960")
endif()
set(CONFIG_SDMMC 1)
set(CONFIG_FATFS 1)

set(CONFIG_AUDIO_CODEC 1)
set(CONFIG_AUDIO_DECODER_WAV 1)

set(CONFIG_MINIMP3 1)

if("${HPM_BUILD_TYPE}" STREQUAL "")
    SET(HPM_BUILD_TYPE flash_sdram_xip)
endif()

set(STACK_SIZE 0x10000)

find_package(hpm-sdk REQUIRED HINTS $ENV{HPM_SDK_BASE})

project(lvgl_audio_player)

if(DEFINED CONFIG_CODEC)
sdk_compile_definitions(-DUSING_CODEC=1)
else()
sdk_compile_definitions(-DUSING_DAO=1)
endif()
sdk_compile_definitions(-DCONFIG_LV_TOUCH=1)
sdk_compile_definitions(-DLV_USE_DEMO_MUSIC=1)
sdk_compile_definitions(-DCONFIG_LV_HAS_EXTRA_CONFIG="lv_app_conf.h")
sdk_compile_definitions(-DSD_FATFS_ENABLE=1)
sdk_compile_definitions(-DFF_CODE_PAGE=936)
sdk_compile_definitions(-DHPM_LCD_IRQ_PRIORITY=6)
sdk_compile_definitions(-DHPM_LVGL_FRAMEBUFFER_NONCACHEABLE)

sdk_inc(../common/inc)
sdk_app_src(../common/src/audio_codec_common.c)
sdk_app_src(../common/src/sd_fatfs_common.c)
sdk_app_src(../common/src/wav_ctrl_common.c)
sdk_app_src(../common/src/mp3_ctrl_common.c)

sdk_inc(src)
sdk_app_src(src/lvgl_audio_player_main.c)

sdk_inc(src/lv_demo_music)
sdk_inc(src/lv_demo_music/assets)

sdk_src(src/lv_demo_music/lv_demo_music_main.c)
sdk_src(src/lv_demo_music/lv_demo_music_list.c)
sdk_src(src/lv_demo_music/lv_demo_music.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_slider_knob_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_list_border_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_1.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_list_play_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_next.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_cover_1.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_logo.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_corner_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_list_border.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_loop_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_prev_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_4_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_next_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_wave_top.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_2.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_corner_right_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_cover_2.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_list_play.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_play_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_pause_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_loop.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_corner_right.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_pause.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_cover_2_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_list_pause.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_2_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_rnd_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_cover_3.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_3.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_3_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_rnd.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_list_pause_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_corner_left.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_cover_3_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_corner_left_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_prev.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_1_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_icon_4.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_btn_play.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_cover_1_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_wave_bottom.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_wave_bottom_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_wave_top_large.c)
sdk_src(src/lv_demo_music/assets/img_lv_demo_music_slider_knob.c)
sdk_src(src/lv_demo_music/assets/hpmicro_logo.c)
sdk_src(src/lv_demo_music/assets/hpmicro_logo_large.c)
sdk_src(src/lv_demo_music/assets/SourceHanSansCN_Normal_16.c)

sdk_iar_ld_options(--disable_relaxation) # A workaround to fix EWRISCV3.30 linking issue

generate_ide_projects()
